<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>二进制的向阳</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="二进制的向阳"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="二进制的向阳"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="二进制的向阳"><meta property="og:url" content="https://lsksp.github.io/"><meta property="og:site_name" content="二进制的向阳"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://lsksp.github.io/img/og_image.png"><meta property="article:author" content="Shaokui Li"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://lsksp.github.io/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://LSKsp.github.io"},"headline":"二进制的向阳","image":["https://lsksp.github.io/img/og_image.png"],"author":{"@type":"Person","name":"Shaokui Li"},"publisher":{"@type":"Organization","name":"二进制的向阳","logo":{"@type":"ImageObject","url":"https://lsksp.github.io/img/logo.svg"}},"description":""}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 8.0.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="二进制的向阳" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-07-21T16:00:00.000Z" title="2025/7/22 00:00:00">2025-07-22</time>发表</span><span class="level-item"><time dateTime="2025-10-16T17:41:45.000Z" title="2025/10/17 01:41:45">2025-10-17</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Linux/">Linux</a></span><span class="level-item">几秒读完 (大约63个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/Linux/ubuntu%E9%85%8D%E7%BD%AE/">ubuntu config</a></p><div class="content"> <!-- toc -->

<h4 id="一、更新下载镜像源"><a href="#一、更新下载镜像源" class="headerlink" title="一、更新下载镜像源"></a>一、更新下载镜像源</h4><p>修改目标文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/apt/sources.list</span><br></pre></td></tr></table></figure>

<p>地址替换为下述地址：</p>
<ul>
<li>阿里源</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mirrors.aliyun.com</span><br></pre></td></tr></table></figure>

<ul>
<li>清华源</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mirrors.tuna.tsinghua.edu.cn</span><br></pre></td></tr></table></figure>

<p>更新本地安装包数据库：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br></pre></td></tr></table></figure>







</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-07-19T16:00:00.000Z" title="2025/7/20 00:00:00">2025-07-20</time>发表</span><span class="level-item"><time dateTime="2025-10-16T17:41:45.000Z" title="2025/10/17 01:41:45">2025-10-17</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E5%86%8D%E6%8E%A2C%E8%AF%AD%E8%A8%80/">再探C语言</a></span><span class="level-item">5 分钟读完 (大约765个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/%E5%86%8D%E6%8E%A2C%E8%AF%AD%E8%A8%80/typedef%E7%94%A8%E6%B3%95/">typedef用法</a></p><div class="content"> <!-- toc -->

<p><strong>良好的代码习惯</strong>和<strong>高效的类型定义</strong>在项目中扮演着至关重要的角色。<strong><code>typedef</code></strong>，它不仅是一个语法糖，更是提升代码质量和可维护性的利器。在这篇文章中，将为你介绍<code>typedef</code>  4 种应用方式。</p>
<h4 id="应用一、为基本数据类型定义新的类型名"><a href="#应用一、为基本数据类型定义新的类型名" class="headerlink" title="应用一、为基本数据类型定义新的类型名"></a>应用一、为基本数据类型定义新的类型名</h4><p>用<code>uint32_t</code>替代<code>unsigned int</code>声明变量</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 变量名重定义 */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">int</span> <span class="type">uint32_t</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 定义一个`unsigned int`类型的变量 */</span></span><br><span class="line"><span class="type">uint32_t</span> count = <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<h4 id="应用二、为自定义数据类型（结构体、共用体和枚举类型）定义简洁的类型名称"><a href="#应用二、为自定义数据类型（结构体、共用体和枚举类型）定义简洁的类型名称" class="headerlink" title="应用二、为自定义数据类型（结构体、共用体和枚举类型）定义简洁的类型名称"></a>应用二、为自定义数据类型（结构体、共用体和枚举类型）定义简洁的类型名称</h4><p>使用结构体定义以及声明结构体变量：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TagPoint</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">double</span> x;</span><br><span class="line">    <span class="type">double</span> y;</span><br><span class="line">    <span class="type">double</span> z;</span><br><span class="line">&#125;;<span class="comment">/* 定义一个三维坐标结构体 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 声明一个三维坐标点 */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TagPoint</span> <span class="title">point</span> =</span> &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;;</span><br></pre></td></tr></table></figure>

<p>使用typedef代替结构体定义以及声明结构体变量：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">double</span> x;</span><br><span class="line">    <span class="type">double</span> y;</span><br><span class="line">    <span class="type">double</span> z;</span><br><span class="line">&#125; TagPoint;<span class="comment">/* 定义一个三维坐标结构体 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 声明一个三维坐标点 */</span></span><br><span class="line">TagPoint point = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="应用三、定义数组类型"><a href="#应用三、定义数组类型" class="headerlink" title="应用三、定义数组类型"></a>应用三、定义数组类型</h4><p>定义多个同纬度的数组：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> v[<span class="number">3</span>];</span><br><span class="line"><span class="type">int</span> i[<span class="number">3</span>];</span><br></pre></td></tr></table></figure>

<p>使用typedef重定义：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 定义数组类型 */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> arry_int_3[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 等价于 int v[3] */</span></span><br><span class="line">arry_int_3 v;</span><br></pre></td></tr></table></figure>

<h4 id="应用四、定义指针类型"><a href="#应用四、定义指针类型" class="headerlink" title="应用四、定义指针类型"></a>应用四、定义指针类型</h4><h5 id="1、定义数组指针类型"><a href="#1、定义数组指针类型" class="headerlink" title="1、定义数组指针类型"></a>1、定义数组指针类型</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 普通数组指针 */</span></span><br><span class="line"><span class="type">int</span> (*arr_p)[<span class="number">5</span>];<span class="comment">//定义了一个数组指针变量arr_p，arr_p可以指向一个int a[5]的一维数组</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 使用typedef */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="title function_">int</span><span class="params">(*Arr_P)</span>[5];<span class="comment">//定义一个指针类型，该类型的指针可以指向含5个int元素的一维数组</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a[<span class="number">5</span>] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</span><br><span class="line">Arr_P p;<span class="comment">//定义数组指针变量p</span></span><br><span class="line">p= &amp;a;<span class="comment">//完全合法，无警告    </span></span><br><span class="line">p= (Arr_P)&amp;a;<span class="comment">//类型强制转换为Arr_P，完全合法，无警告</span></span><br></pre></td></tr></table></figure>

<h5 id="2、定义函数指针类型"><a href="#2、定义函数指针类型" class="headerlink" title="2、定义函数指针类型"></a>2、定义函数指针类型</h5><p>有一个函数原型如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 函数原型 */</span></span><br><span class="line"><span class="type">int32_t</span> <span class="title function_">write_adc_reg</span><span class="params">(<span class="type">uint32_t</span> reg_addr, <span class="type">uint32_t</span> data, <span class="type">uint32_t</span> chip_id)</span>;</span><br><span class="line"><span class="type">int32_t</span> <span class="title function_">write_spi_reg</span><span class="params">(<span class="type">uint32_t</span> reg_addr, <span class="type">uint32_t</span> data, <span class="type">uint32_t</span> chip_id)</span>;</span><br></pre></td></tr></table></figure>

<p>普通定义一个函数指针指向这个函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 普通函数指针定义和使用 */</span></span><br><span class="line"><span class="type">int32_t</span> (*write_adc_reg_p)(<span class="type">uint32_t</span>, <span class="type">uint32_t</span>, <span class="type">uint32_t</span>);</span><br><span class="line"><span class="type">int32_t</span> (*write_spi_reg_p)(<span class="type">uint32_t</span>, <span class="type">uint32_t</span>, <span class="type">uint32_t</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 选择不同的写入接口 */</span></span><br><span class="line">write_adc_reg_p = write_adc_reg;</span><br><span class="line">write_spi_reg_p = write_spi_reg;</span><br><span class="line"><span class="comment">/* 调用 */</span></span><br><span class="line"><span class="type">int32_t</span> result = write_reg_p(<span class="number">0x10</span>, <span class="number">0x55</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p>使用typedef：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 定义函数指针类型 */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="title function_">int32_t</span> <span class="params">(*WriteReg_P)</span><span class="params">(<span class="type">uint32_t</span>, <span class="type">uint32_t</span>, <span class="type">uint32_t</span>)</span>;</span><br><span class="line"><span class="comment">/* 声明两个函数指针变量 */</span></span><br><span class="line">WriteReg_P write_adc_reg_p = write_adc_reg;</span><br><span class="line">WriteReg_P write_spi_reg_p = write_spi_reg;</span><br><span class="line"><span class="comment">/* 调用 */</span></span><br><span class="line"><span class="type">int32_t</span> adc_val = write_adc_reg_p(<span class="number">0x10</span>, <span class="number">0x55</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<h4 id="五、总结"><a href="#五、总结" class="headerlink" title="五、总结"></a>五、总结</h4><p><code>typedef</code> 是 C 语言中非常实用的工具，它不仅能提升代码的可读性，还便于后续维护和扩展。在嵌入式开发中，通过合理使用 <code>typedef</code>，我们可以简化结构体、指针、函数指针等复杂类型的声明，让代码更清晰、表达更简洁。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-07-10T16:00:00.000Z" title="2025/7/11 00:00:00">2025-07-11</time>发表</span><span class="level-item"><time dateTime="2025-10-18T19:07:01.925Z" title="2025/10/19 03:07:01">2025-10-19</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/MCU%E5%BC%80%E5%8F%91/">MCU开发</a></span><span class="level-item">13 分钟读完 (大约1904个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/MCU%E5%BC%80%E5%8F%91/MPU%E5%86%85%E5%AD%98%E4%BF%9D%E6%8A%A4%E5%8D%95%E5%85%83/">MPU内存保护单元</a></p><div class="content"> <!-- toc -->

<p>MPU，即内存保护单元，可以设置不同存储区域的存储器访问特性（<strong>用户级</strong>、<strong>特权访问</strong>、<strong>全访问</strong>）和<strong>存储器属性</strong>（如可缓存、可缓冲、可共享），对<strong>存储器（主要是内存和外设）提供保护</strong>，从而提高系统可靠性。</p>
<ul>
<li><strong>存储器访问特性</strong></li>
</ul>
<table>
<thead>
<tr>
<th align="left">权限类型</th>
<th align="left">特权模式（内核）</th>
<th align="left">用户任务</th>
<th align="left">典型用途</th>
</tr>
</thead>
<tbody><tr>
<td align="left">特权只读（PRIV_RO）</td>
<td align="left">可读</td>
<td align="left">不可访问 (触发故障)</td>
<td align="left">保护只读内核代码&#x2F;常量</td>
</tr>
<tr>
<td align="left">特权读写（PRIV_RW）</td>
<td align="left">可读写</td>
<td align="left">不可访问 (触发故障)</td>
<td align="left">内核数据结构、关键寄存器</td>
</tr>
<tr>
<td align="left">全访问(FULL_ACCESS)</td>
<td align="left">可读写</td>
<td align="left">可读写</td>
<td align="left">用户堆栈、共享内存</td>
</tr>
</tbody></table>
<ul>
<li><p><strong>存储器属性</strong></p>
<table>
<thead>
<tr>
<th align="left">存储器属性</th>
<th align="left">硬件行为</th>
<th align="left">数据一致性</th>
<th align="left">典型用途</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>可缓存</strong></td>
<td align="left">读写经过Cache</td>
<td align="left">需软件维护（Clean&#x2F;Invalidate）</td>
<td align="left">单核私有高性能数据</td>
</tr>
<tr>
<td align="left"><strong>可缓冲</strong></td>
<td align="left">写入通过Write Buffer异步完成</td>
<td align="left">可能导致顺序重排</td>
<td align="left">低速外设寄存器</td>
</tr>
<tr>
<td align="left"><strong>可共享</strong></td>
<td align="left">允许多主设备访问</td>
<td align="left">硬件强制同步或禁用缓存</td>
<td align="left">DMA缓冲区、多核共享内存</td>
</tr>
</tbody></table>
</li>
<li><p><strong>作用</strong></p>
<ul>
<li><p>阻止用户应用程序破坏操作系统使用的数据；</p>
</li>
<li><p>阻止一个任务访问其他任务的数据区，从而隔离任务；</p>
</li>
<li><p>把关键数据区域设置为只读从根本上解决被破切的可能；</p>
</li>
<li><p>检测意外的存储访问，如堆栈溢出、数组越界等；</p>
</li>
<li><p>将SRAM或RAM空间定义为不可执行，防止注入攻击；</p>
</li>
</ul>
</li>
</ul>
<h2 id="STM32的MPU保护单元配置"><a href="#STM32的MPU保护单元配置" class="headerlink" title="STM32的MPU保护单元配置"></a>STM32的MPU保护单元配置</h2><p>在STM32H743（Cortex-M7内核）中，MPU可配置保护16个内存保护区域，每个区域最小要求256字节，且每一个区域还可配置为8个子域（大小一样）。</p>
<h4 id="一、MPU控制模式"><a href="#一、MPU控制模式" class="headerlink" title="一、MPU控制模式"></a>一、MPU控制模式</h4><p><strong>MPU（Memory Protection Unit）控制模式</strong>决定了在默认状态或异常处理期间MPU的行为及其对内存访问的影响。</p>
<table>
<thead>
<tr>
<th align="left">控制模式</th>
<th align="left">背景区域行为</th>
<th align="left">异常期间MPU状态</th>
<th align="left">安全性</th>
<th align="left">典型用途</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>NOT USED</strong></td>
<td align="left">无，所有内存开放</td>
<td align="left">无效</td>
<td align="left">无</td>
<td align="left">调试&#x2F;无保护需求</td>
</tr>
<tr>
<td align="left"><strong>BR禁访+MPU异常禁用</strong></td>
<td align="left">不可访问</td>
<td align="left">禁用</td>
<td align="left">中</td>
<td align="left">通用RTOS</td>
</tr>
<tr>
<td align="left"><strong>BR禁访+MPU异常启用</strong></td>
<td align="left">不可访问</td>
<td align="left">启用</td>
<td align="left">高</td>
<td align="left">高安全固件</td>
</tr>
<tr>
<td align="left"><strong>BR特权+MPU异常禁用</strong></td>
<td align="left">仅特权访问</td>
<td align="left">禁用</td>
<td align="left">中-高</td>
<td align="left">特权分离系统（如Linux内核空间）</td>
</tr>
<tr>
<td align="left"><strong>BR特权+MPU异常启用</strong></td>
<td align="left">仅特权访问</td>
<td align="left">启用</td>
<td align="left">最高</td>
<td align="left">安全认证产品（ISO 26262 ASIL-D）</td>
</tr>
</tbody></table>
<h4 id="二、三种内存类型"><a href="#二、三种内存类型" class="headerlink" title="二、三种内存类型"></a>二、三种内存类型</h4><ul>
<li>Normal memory：CPU以最高效的方式加载和存储字节、半字和字，CPU对于这种内存区的加载或存储不一定要按照程序代码的顺序执行；</li>
<li>Device memory：加载和存储要严格按照次序进行，硕确保寄存器按照正确顺序执行；</li>
<li>Strongly ordered memory：程序完全按照代码顺序执行，CPU会等待当前加载存储执行完毕后才执行下一条指令，导致性能下降。</li>
</ul>
<table>
<thead>
<tr>
<th align="left">内存类型</th>
<th align="left">适用对象</th>
<th align="left">性能</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Normal memory</td>
<td align="left">ROM、FLASH、SRAM</td>
<td align="left">高</td>
</tr>
<tr>
<td align="left">Device memory</td>
<td align="left">外设</td>
<td align="left">中</td>
</tr>
<tr>
<td align="left">Strongly ordered memory</td>
<td align="left">强序</td>
<td align="left">低</td>
</tr>
</tbody></table>
<img src="/MCU%E5%BC%80%E5%8F%91/MPU%E5%86%85%E5%AD%98%E4%BF%9D%E6%8A%A4%E5%8D%95%E5%85%83/type_of_memory.png" alt="三种内存形式" style="zoom: 50%;">

<h4 id="三、Cache介绍"><a href="#三、Cache介绍" class="headerlink" title="三、Cache介绍"></a>三、Cache介绍</h4><p>Cache(高级缓存)是提升STM32性能的关键一步。M7内核芯片做了一级Cache支持，Cache分为数据缓存D-Cache和指令缓存I-Cache。</p>
<p>Cache支持4种基本操作：(使能、清空、禁止、无效化）。</p>
<img src="/MCU%E5%BC%80%E5%8F%91/MPU%E5%86%85%E5%AD%98%E4%BF%9D%E6%8A%A4%E5%8D%95%E5%85%83/image-20250715090857174.png" alt="image-20250715090857174" style="zoom: 50%;">

<p>数据缓存D-Cache是解决CPU加速访问SRAM，MPU能够指定区域的Cache策略</p>
<h5 id="1、Cache写操作"><a href="#1、Cache写操作" class="headerlink" title="1、Cache写操作"></a>1、Cache写操作</h5><ul>
<li><p>写命中（Cache hit）：CPU要写的SRAM区数据在Cache中已经开辟了对应的区域；</p>
<table>
<thead>
<tr>
<th align="left">处理方式</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">write through</td>
<td align="left">直接写到内存并并同时放到cache里面，内存和cache同步更新</td>
</tr>
<tr>
<td align="left">write back</td>
<td align="left">数据更新时只写入cache，只有数据替换时被修改的cache数据才写到内存</td>
</tr>
</tbody></table>
</li>
<li><p>写不命中（Cache Miss）：Cache里面没有开辟对应的区域；</p>
<table>
<thead>
<tr>
<th align="left">处理方式</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">write allocate</td>
<td align="left">把要写的数据载入到cache，对cache写后更新到内存</td>
</tr>
<tr>
<td align="left">no write allocate</td>
<td align="left">直接写入内存</td>
</tr>
</tbody></table>
</li>
</ul>
<h5 id="2、Cache读操作"><a href="#2、Cache读操作" class="headerlink" title="2、Cache读操作"></a>2、Cache读操作</h5><ul>
<li><p>读命中（Cache hit）：CPU要读取的SRAM区数据在Cache中已经加载好；</p>
<table>
<thead>
<tr>
<th align="left">处理方式</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Cache read</td>
<td align="left">直接从cache中读出数据即可（不能保证数据一致性）</td>
</tr>
</tbody></table>
</li>
<li><p>读不命中（Cache Miss）：Cache里面没有需要读的数据；</p>
<table>
<thead>
<tr>
<th align="left">处理方式</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">read through</td>
<td align="left">直接从内存中读出，不用cache</td>
</tr>
<tr>
<td align="left">read allocate</td>
<td align="left">把数据从内存加载到cache，再从cache读取</td>
</tr>
</tbody></table>
</li>
</ul>
<h5 id="2、数据一致性解决"><a href="#2、数据一致性解决" class="headerlink" title="2、数据一致性解决"></a>2、数据一致性解决</h5><ul>
<li><p>设置共享属性</p>
<p>Cache相当于没有开启。</p>
</li>
<li><p>软件维护</p>
<table>
<thead>
<tr>
<th align="left">操作</th>
<th align="left">函数</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">clean清空</td>
<td align="left">SCB_CleanDCache()</td>
<td align="left">当Cache已变化，内存没有更新时，DMA搬运之前进行此操作，将Cache同步到内存</td>
</tr>
<tr>
<td align="left">invalidata无效化</td>
<td align="left">SCB_InvalidataDCache()</td>
<td align="left">当SRAM数据已变化，Cache未更新时,DMA搬运数据后，将SRAM数据同步到Cache中</td>
</tr>
</tbody></table>
</li>
</ul>
<h4 id="二、区域设置"><a href="#二、区域设置" class="headerlink" title="二、区域设置"></a>二、区域设置</h4><table>
<thead>
<tr>
<th align="left">配置项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">MPU Region</td>
<td align="left">参数类型：Enable&#x2F;Disable，是否启用区域MPU区域保护</td>
</tr>
<tr>
<td align="left">MPU Region Base Address</td>
<td align="left">定义Region 0的起始地址（地址必须按区域大小对齐）</td>
</tr>
<tr>
<td align="left">MPU Region Size</td>
<td align="left">设置Region 0覆盖的内存大小。</td>
</tr>
<tr>
<td align="left">MPU TEX field level</td>
<td align="left">扩展内存类型（用于细化内存属性和缓存策略）</td>
</tr>
<tr>
<td align="left">MPU Shareability Permission</td>
<td align="left">参数类型：Enable&#x2F;Disable，是否共享</td>
</tr>
<tr>
<td align="left">MPU Cacheable Permissionn</td>
<td align="left">参数类型：Enable&#x2F;Disable，是否缓存</td>
</tr>
<tr>
<td align="left">MPU Bufferable Permissionn</td>
<td align="left">参数类型：Enable&#x2F;Disable，是否缓冲</td>
</tr>
<tr>
<td align="left">MPU Instruction Access</td>
<td align="left">参数类型：Enable&#x2F;Disable，是否使能从该区域执行指令。</td>
</tr>
<tr>
<td align="left">MPU Access Permission</td>
<td align="left">见下表</td>
</tr>
</tbody></table>
<p>TEX是内存的“身份证”，告诉硬件它属于哪一类（普通RAM、设备寄存器还是特殊内存），而C&#x2F;B是它的“行为指南”（如何读写）。两者协作但职责分离。</p>
<img src="/MCU%E5%BC%80%E5%8F%91/MPU%E5%86%85%E5%AD%98%E4%BF%9D%E6%8A%A4%E5%8D%95%E5%85%83/mpu_tex_c_b.png" alt="2023-07-02" style="zoom: 50%;">

<ul>
<li><p>MPU设置内存的访问权限（MPU Access Permission）</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">执行（x）</th>
<th align="left">读（R）</th>
<th align="left">写（W）</th>
<th align="left">典型用途</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong><code>ALL ACCESS NOT PERMITTED</code></strong></td>
<td align="left">❌</td>
<td align="left">❌</td>
<td align="left">❌</td>
<td align="left">内存隔离&#x2F;非法访问检测</td>
</tr>
<tr>
<td align="left"><strong><code>Privileged READS</code></strong></td>
<td align="left">❌</td>
<td align="left">✔️</td>
<td align="left">❌</td>
<td align="left">只读配置表（仅内核可访问）</td>
</tr>
<tr>
<td align="left"><strong><code>Privileged READS + Unprivileged READS</code></strong></td>
<td align="left">❌</td>
<td align="left">✔️</td>
<td align="left">❌</td>
<td align="left">全局只读数据</td>
</tr>
<tr>
<td align="left"><strong><code>Privileged READ/WRITE</code></strong></td>
<td align="left">❌</td>
<td align="left">✔️</td>
<td align="left">✔️</td>
<td align="left">内核数据结构 &#x2F; 外设寄存器</td>
</tr>
<tr>
<td align="left"><strong><code>Privileged READ/WRITE + Unprivileged READS</code></strong></td>
<td align="left">❌</td>
<td align="left">✔️</td>
<td align="left">❌</td>
<td align="left">安全日志（用户只读，内核可写）</td>
</tr>
<tr>
<td align="left"><strong><code>ALL ACCESS PERMITTED</code></strong></td>
<td align="left">✔️</td>
<td align="left">✔️</td>
<td align="left">✔️</td>
<td align="left">完全开放区域（调试&#x2F;启动阶段）</td>
</tr>
</tbody></table>
</li>
</ul>
<h4 id="三、建议配（MPU-TEX-LEVEL0）（注意考虑数据一致性问题）"><a href="#三、建议配（MPU-TEX-LEVEL0）（注意考虑数据一致性问题）" class="headerlink" title="三、建议配（MPU_TEX_LEVEL0）（注意考虑数据一致性问题）"></a>三、建议配（MPU_TEX_LEVEL0）（注意考虑数据一致性问题）</h4><table>
<thead>
<tr>
<th align="left">设备</th>
<th align="left">基地址</th>
<th align="left">区域大小</th>
<th align="left">指令访问</th>
<th align="left">访问权限</th>
<th align="left">共享、Cache、缓冲</th>
</tr>
</thead>
<tbody><tr>
<td align="left">DTCM</td>
<td align="left">0x2000 0000</td>
<td align="left">128K</td>
<td align="left">允许</td>
<td align="left">全访问</td>
<td align="left">不共享、cache、缓冲</td>
</tr>
<tr>
<td align="left">AXI SRAM</td>
<td align="left">0x2400 0000</td>
<td align="left">512K</td>
<td align="left">允许</td>
<td align="left">全访问</td>
<td align="left">不共享、cache、缓冲</td>
</tr>
<tr>
<td align="left">SRAM1~3</td>
<td align="left">0x3000 0000</td>
<td align="left">512K</td>
<td align="left">允许</td>
<td align="left">全访问</td>
<td align="left">不共享、cache、缓冲</td>
</tr>
<tr>
<td align="left">SRAM4</td>
<td align="left">0x3800 0000</td>
<td align="left">64K</td>
<td align="left">允许</td>
<td align="left">全访问</td>
<td align="left">不共享、cache、缓冲</td>
</tr>
<tr>
<td align="left">FMC</td>
<td align="left">0x6000 0000</td>
<td align="left">64M</td>
<td align="left">允许</td>
<td align="left">全访问</td>
<td align="left">不共享、不cache、不缓冲</td>
</tr>
<tr>
<td align="left">SDRAM</td>
<td align="left">OxC000 0000</td>
<td align="left">64M</td>
<td align="left">允许</td>
<td align="left">全访问</td>
<td align="left">不共享、cache、缓冲</td>
</tr>
<tr>
<td align="left">NAND</td>
<td align="left">0x8000 0000</td>
<td align="left">256M</td>
<td align="left">不允许</td>
<td align="left">全访问</td>
<td align="left">不共享、不cache、不缓冲</td>
</tr>
<tr>
<td align="left">SPI FLASH</td>
<td align="left">0x9000 0000</td>
<td align="left">8M</td>
<td align="left">允许</td>
<td align="left">全访问</td>
<td align="left">不共享、cache、缓冲</td>
</tr>
</tbody></table>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-06-23T16:00:00.000Z" title="2025/6/24 00:00:00">2025-06-24</time>发表</span><span class="level-item"><time dateTime="2025-10-16T17:41:45.000Z" title="2025/10/17 01:41:45">2025-10-17</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/">工具使用</a></span><span class="level-item">4 分钟读完 (大约555个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Git%E4%BD%BF%E7%94%A8/">Git使用</a></p><div class="content"><!-- toc -->

<h4 id="一、Git配置："><a href="#一、Git配置：" class="headerlink" title="一、Git配置："></a>一、Git配置：</h4><ul>
<li>打开Git Bash依次输入以下命令配置个人信息：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot;名称&quot;</span><br><span class="line">git config --global user.email 邮箱地址</span><br><span class="line">git config --global user.password 密码</span><br></pre></td></tr></table></figure>

<ul>
<li>输入以下命令可以查看个人配置信息</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global --list</span><br></pre></td></tr></table></figure>

<ul>
<li>在User下找到.ssh文件夹生成id_rsa.pub文件作为SSH密钥</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure>

<ul>
<li>配置配置.gitignore文件以此来忽略不需要提交的git文件</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">####################################################################################</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">###   gitIgnore For Keil</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">####################################################################################</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Prerequisites</span></span><br><span class="line">*.d</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Compiled Object files</span></span><br><span class="line">*.slo</span><br><span class="line">*.lo</span><br><span class="line">*.o</span><br><span class="line">*.obj</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Precompiled Headers</span></span><br><span class="line">*.gch</span><br><span class="line">*.pch</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Compiled Dynamic libraries</span></span><br><span class="line">*.so</span><br><span class="line">*.dylib</span><br><span class="line">*.dll</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Fortran module files</span></span><br><span class="line">*.mod</span><br><span class="line">*.smod</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Compiled Static libraries</span></span><br><span class="line">*.lai</span><br><span class="line">*.la</span><br><span class="line">*.a</span><br><span class="line">*.lib</span><br><span class="line">*.ia</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Executables</span></span><br><span class="line">*.exe</span><br><span class="line">*.out</span><br><span class="line">*.app</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vscode</span></span><br><span class="line">.vscode</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Keil</span></span><br><span class="line">DebugConfig</span><br><span class="line">RTE</span><br><span class="line">*.lst</span><br><span class="line">*.uvguix.*</span><br><span class="line">RTE_Components.h</span><br><span class="line"></span><br><span class="line">/private/</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Compile File</span></span><br><span class="line">*.lst</span><br><span class="line">*.htm</span><br><span class="line">*.sct</span><br><span class="line">*.crf</span><br><span class="line">*.map</span><br><span class="line">*.hex</span><br><span class="line">*.lnp</span><br><span class="line">*.axf</span><br><span class="line">*.dep</span><br><span class="line">*.iex</span><br><span class="line">*.__i</span><br><span class="line">*.Bak</span><br><span class="line">*.scvd</span><br><span class="line">*.html</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="二、Git基础使用"><a href="#二、Git基础使用" class="headerlink" title="二、Git基础使用"></a>二、Git基础使用</h4><ul>
<li>初始化仓库</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure>

<ul>
<li>将文件添加到暂存区</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br></pre></td></tr></table></figure>

<ul>
<li>提交到本地</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m &quot;提交描述&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>连接到远程仓库（不是必须的）</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin xxx</span><br><span class="line">xxx为远程仓库地址，你可自行在gitee上创建仓库</span><br></pre></td></tr></table></figure>

<ul>
<li>提交到远程仓库</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">完整写法</span></span><br><span class="line">git push -u origin 远程分支:本地分支</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">远程分支与本地分支同名</span></span><br><span class="line">git push -u origin 远程分支</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>从远程获取代码并合并本地的版本</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">更新操作</span></span><br><span class="line">git pull</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">将远程主机 origin 的 master 分支拉取过来，与本地的 master 分支合并。</span></span><br><span class="line">git pull origin master:master</span><br></pre></td></tr></table></figure>

<h4 id="二、辅助命令"><a href="#二、辅助命令" class="headerlink" title="二、辅助命令"></a>二、辅助命令</h4><ul>
<li>查看当前文件状态</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git status</span><br></pre></td></tr></table></figure>

<ul>
<li>查看提交日志</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git log</span><br></pre></td></tr></table></figure>

<ul>
<li>为最新一次提交打上标签，一般用于发布版本</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git tag &lt;tagname&gt;</span><br></pre></td></tr></table></figure>

<h4 id="三、分支操作"><a href="#三、分支操作" class="headerlink" title="三、分支操作"></a>三、分支操作</h4><ul>
<li>创建分支（会继承当前分支状态）</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">创建分支</span></span><br><span class="line">git branch &lt;branchname&gt;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">创建分支并切换</span></span><br><span class="line">git checkout -b &lt;branchname&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>切换分支</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout &lt;branchname&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>查看分支</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看本地分支</span></span><br><span class="line">git branch</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看远程分支</span></span><br><span class="line">git branch -a</span><br></pre></td></tr></table></figure>

<ul>
<li>将某分支合并到当前分支</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git merge &lt;branchname&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>删除分支</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">删除本地分支</span></span><br><span class="line">git branch -d &lt;branchname&gt;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">强制删除未合并的分支</span></span><br><span class="line">git branch -D &lt;branchname&gt;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">删除远程分支</span></span><br><span class="line">git push origin --delete &lt;branchname&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>如果git merge的时候出现冲突，可以执行下面的命令取消merge</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git merge --abort</span><br></pre></td></tr></table></figure>



</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-06-10T16:00:00.000Z" title="2025/6/11 00:00:00">2025-06-11</time>发表</span><span class="level-item"><time dateTime="2025-10-16T17:41:45.000Z" title="2025/10/17 01:41:45">2025-10-17</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/">工具使用</a></span><span class="level-item">3 分钟读完 (大约477个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/PM2%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/">PM2进程管理工具</a></p><div class="content"><!-- toc -->

<h4 id="一、安装PM2"><a href="#一、安装PM2" class="headerlink" title="一、安装PM2"></a>一、安装PM2</h4><ul>
<li>nvm是官方安装nodejs的工具，安装方式如下：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装 nvm (Node 版本管理器)</span></span><br><span class="line">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.0/install.sh | bash</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">如果上面进度慢，可以尝试国内镜像版本</span></span><br><span class="line">curl -o- https://gitee.com/mirrors/nvm/raw/v0.40.0/install.sh | bash</span><br></pre></td></tr></table></figure>

<ul>
<li>更改Node.js 下载镜像源（如淘宝镜像）：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">临时生效</span></span><br><span class="line">export NVM_NODEJS_ORG_MIRROR=https://npmmirror.com/mirrors/node</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">永久生效（写入Shell配置文件）</span></span><br><span class="line">echo &#x27;export NVM_NODEJS_ORG_MIRROR=&quot;https://npmmirror.com/mirrors/node&quot;&#x27; &gt;&gt; ~/.bashrc</span><br><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure>

<ul>
<li>下载nodejs</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下载并安装 Node.js（可能需要重启终端）</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">第一次安装之后可能没有 nvm 命令，退出终端，再进一遍就好了</span></span><br><span class="line">nvm install 22</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">验证环境中是否存在正确的 Node.js 版本</span></span><br><span class="line">node -v # 应该打印 `v22.12.0`</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">验证环境中是否存在正确的 npm 版本</span></span><br><span class="line">npm -v # 应该打印 `10.9.0`</span><br></pre></td></tr></table></figure>

<ul>
<li>安装PM2</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install pm2 -g</span><br></pre></td></tr></table></figure>

<h4 id="二、PM2的使用"><a href="#二、PM2的使用" class="headerlink" title="二、PM2的使用"></a>二、PM2的使用</h4><ul>
<li>查看PM2版本</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pm2 -v</span><br></pre></td></tr></table></figure>

<ul>
<li>编写pm2的js脚本，这里编写（hexo启动版本，hexo_run.js）</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//run</span></span><br><span class="line"><span class="keyword">const</span> &#123; exec &#125; = <span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>)</span><br><span class="line"><span class="title function_">exec</span>(<span class="string">&#x27;hexo server&#x27;</span>,<span class="function">(<span class="params">error, stdout, stderr</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(error)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;exec error: $&#123;error&#125;&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;stdout: $&#123;stdout&#125;&#x27;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;stderr: $&#123;stderr&#125;&#x27;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>启动进程服务</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">简单启动进程</span></span><br><span class="line">pm2 start hexo_run.js</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动进程，命名为为hexo_run</span></span><br><span class="line">pm2 start app.js --name hexo_run</span><br></pre></td></tr></table></figure>

<ul>
<li>结束进程</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">结束某个进程</span></span><br><span class="line">pm2 stop ID/名字</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">停止所有进程</span></span><br><span class="line">pm2 stop all</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">重新启动所有进程</span></span><br><span class="line">pm2 restart all</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">重新加载一个由 PM2 管理的应用程序。重新启动应用进程，不会中断服务。</span></span><br><span class="line">pm2 reload hexo_run.js</span><br></pre></td></tr></table></figure>

<ul>
<li>查看所有进程状态</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pm2 list</span><br></pre></td></tr></table></figure>

<ul>
<li>日志管理</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看所有进程状态</span></span><br><span class="line">pm2 logs</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看某个进程状态</span></span><br><span class="line">pm2 logs ID/名字</span><br></pre></td></tr></table></figure>

<ul>
<li>删除应用</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">删除某个进程</span></span><br><span class="line">pm2 delete ID/名字</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">删除所有进程</span></span><br><span class="line">pm2 delete all</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-05-27T16:00:00.000Z" title="2025/5/28 00:00:00">2025-05-28</time>发表</span><span class="level-item"><time dateTime="2025-10-16T17:41:45.000Z" title="2025/10/17 01:41:45">2025-10-17</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/MCU%E5%BC%80%E5%8F%91/">MCU开发</a></span><span class="level-item">36 分钟读完 (大约5350个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/MCU%E5%BC%80%E5%8F%91/FreeRTOS%E5%AD%A6%E4%B9%A0/">FreeRTOS</a></p><div class="content"> <!-- toc -->

<h3 id="1、动态创建任务"><a href="#1、动态创建任务" class="headerlink" title="1、动态创建任务"></a>1、动态创建任务</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;driver_led.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;driver_key.h&quot;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeRTOS_Start</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 初始化HAL库函数必须要调用此函数</span></span><br><span class="line">    HAL_Init();</span><br><span class="line">    <span class="comment">// 系统时钟即AHB/APB时钟配置</span></span><br><span class="line">    SystemClock_Config();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化LED</span></span><br><span class="line">    LedGpioInit();</span><br><span class="line">    KeyInit();</span><br><span class="line">    FreeRTOS_Start();</span><br><span class="line">&#125;</span><br><span class="line">TaskHandle_t start_task_handle;</span><br><span class="line">TaskHandle_t task1_handle;</span><br><span class="line">TaskHandle_t task2_handle;</span><br><span class="line">TaskHandle_t task3_handle;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">StartTask</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Task1</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Task2</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Task3</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeRTOS_Start</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    StartTask,              <span class="comment">//任务函数的地址          </span></span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;StartTask&quot;</span>,            <span class="comment">//任务函数的名称</span></span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,                    <span class="comment">//任务函数栈空间大小</span></span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,                   <span class="comment">//任务函数的参数</span></span><br><span class="line">        (UBaseType_t)       <span class="number">1</span>,                      <span class="comment">//任务函数的优先级</span></span><br><span class="line">        (TaskHandle_t*)     &amp;start_task_handle      <span class="comment">//任务函数的句柄</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">//启动调度器</span></span><br><span class="line">    vTaskStartScheduler();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">StartTask</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    taskENTER_CRITICAL();</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    Task1,</span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;Task1&quot;</span>,</span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,</span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,</span><br><span class="line">        (UBaseType_t)       <span class="number">2</span>,</span><br><span class="line">        (TaskHandle_t*)     &amp;task1_handle</span><br><span class="line">    );</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    Task2,</span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;Task2&quot;</span>,</span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,</span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,</span><br><span class="line">        (UBaseType_t)       <span class="number">3</span>,</span><br><span class="line">        (TaskHandle_t*)     &amp;task2_handle</span><br><span class="line">    );</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    Task3,</span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;Task3&quot;</span>,</span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,</span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,</span><br><span class="line">        (UBaseType_t)       <span class="number">4</span>,</span><br><span class="line">        (TaskHandle_t*)     &amp;task3_handle</span><br><span class="line">    );</span><br><span class="line">    vTaskDelete(<span class="literal">NULL</span>);</span><br><span class="line">    taskEXIT_CRITICAL();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Task1</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        LED_TOGGLE(LED0_GPIO_PORT,LED0_GPIO_PIN);</span><br><span class="line">        vTaskDelay(<span class="number">500</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Task2</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        LED_TOGGLE(LED1_GPIO_PORT,LED1_GPIO_PIN);</span><br><span class="line">        vTaskDelay(<span class="number">500</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Task3</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(KeyScan() == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(task1_handle != <span class="literal">NULL</span>) vTaskDelete(task1_handle);</span><br><span class="line">            task1_handle = <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    vTaskDelay(<span class="number">500</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2、静态创建任务"><a href="#2、静态创建任务" class="headerlink" title="2、静态创建任务"></a>2、静态创建任务</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;driver_led.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;driver_key.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 启动任务的配置 */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> START_TASK_STACK 128</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> START_TASK_PRIORITY 1</span></span><br><span class="line">TaskHandle_t start_task_handle;</span><br><span class="line">StackType_t start_task_stack[START_TASK_STACK]; <span class="comment">// 静态任务的任务栈，以数组形式存储</span></span><br><span class="line">StaticTask_t start_task_tcb;                    <span class="comment">// 静态任务的TCB结构体类型</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">start_task</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 任务1的配置 */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TASK1_STACK 128</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TASK1_PRIORITY 2</span></span><br><span class="line">TaskHandle_t task1_handle;</span><br><span class="line">StackType_t task1_stack[TASK1_STACK]; <span class="comment">// 静态任务的任务栈，以数组形式存储</span></span><br><span class="line">StaticTask_t task1_tcb;               <span class="comment">// 静态任务的TCB结构体类型</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">task1</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 任务2的配置 */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TASK2_STACK 128</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TASK2_PRIORITY 3</span></span><br><span class="line">TaskHandle_t task2_handle;</span><br><span class="line">StackType_t task2_stack[TASK2_STACK]; <span class="comment">// 静态任务的任务栈，以数组形式存储</span></span><br><span class="line">StaticTask_t task2_tcb;               <span class="comment">// 静态任务的TCB结构体类型</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">task2</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 任务3的配置 */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TASK3_STACK 128</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TASK3_PRIORITY 4</span></span><br><span class="line">TaskHandle_t task3_handle;</span><br><span class="line">StackType_t task3_stack[TASK3_STACK]; <span class="comment">// 静态任务的任务栈，以数组形式存储</span></span><br><span class="line">StaticTask_t task3_tcb;               <span class="comment">// 静态任务的TCB结构体类型</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">task3</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ======================= 静态创建方式，需要手动指定2个特殊任务的资源=============================== */</span></span><br><span class="line"><span class="comment">/* 空闲任务的配置 */</span></span><br><span class="line">StackType_t idle_task_stack[configMINIMAL_STACK_SIZE]; <span class="comment">// 静态任务的任务栈，以数组形式存储</span></span><br><span class="line">StaticTask_t idle_task_tcb;                            <span class="comment">// 静态任务的TCB结构体类型</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 软件定时器任务的配置 */</span></span><br><span class="line">StackType_t timer_task_stack[configTIMER_TASK_STACK_DEPTH]; <span class="comment">// 静态任务的任务栈，以数组形式存储</span></span><br><span class="line">StaticTask_t timer_task_tcb;                            <span class="comment">// 静态任务的TCB结构体类型</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 分配空闲任务的资源 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">vApplicationGetIdleTaskMemory</span><span class="params">(StaticTask_t **ppxIdleTaskTCBBuffer,</span></span><br><span class="line"><span class="params">                                   StackType_t **ppxIdleTaskStackBuffer,</span></span><br><span class="line"><span class="params">                                   <span class="type">uint32_t</span> *pulIdleTaskStackSize)</span></span><br><span class="line">&#123;</span><br><span class="line">    *ppxIdleTaskTCBBuffer = &amp;idle_task_tcb;</span><br><span class="line">    *ppxIdleTaskStackBuffer = idle_task_stack;</span><br><span class="line">    *pulIdleTaskStackSize = configMINIMAL_STACK_SIZE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 分配软件定时器任务的资源 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">vApplicationGetTimerTaskMemory</span><span class="params">(StaticTask_t **ppxTimerTaskTCBBuffer,</span></span><br><span class="line"><span class="params">                                    StackType_t **ppxTimerTaskStackBuffer,</span></span><br><span class="line"><span class="params">                                    <span class="type">uint32_t</span> *pulTimerTaskStackSize)</span></span><br><span class="line">&#123;</span><br><span class="line">    *ppxTimerTaskTCBBuffer = &amp;timer_task_tcb;</span><br><span class="line">    *ppxTimerTaskStackBuffer = timer_task_stack;</span><br><span class="line">    *pulTimerTaskStackSize = configTIMER_TASK_STACK_DEPTH;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @description: 启动FreeRTOS</span></span><br><span class="line"><span class="comment"> * @return &#123;*&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeRTOS_Start</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* 1.创建一个启动任务 */</span></span><br><span class="line">    start_task_handle = xTaskCreateStatic(</span><br><span class="line">        (TaskFunction_t)start_task,       <span class="comment">// 任务函数的地址</span></span><br><span class="line">        (<span class="type">char</span> *)<span class="string">&quot;start_task&quot;</span>,             <span class="comment">// 任务名字符串</span></span><br><span class="line">        (<span class="type">uint32_t</span>)START_TASK_STACK,       <span class="comment">// 任务栈大小，默认最小128，单位4字节</span></span><br><span class="line">        (<span class="type">void</span> *)<span class="literal">NULL</span>,                     <span class="comment">// 传递给任务的参数</span></span><br><span class="line">        (UBaseType_t)START_TASK_PRIORITY, <span class="comment">// 任务的优先级</span></span><br><span class="line">        (StackType_t *)start_task_stack,  <span class="comment">// 我们创建的任务栈（数组存储）的地址</span></span><br><span class="line">        (StaticTask_t *)&amp;start_task_tcb   <span class="comment">// 我们创建的tcb的地址</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 2.启动调度器:会自动创建空闲任务和软件定时器（如果开启），</span></span><br><span class="line"><span class="comment">       静态创建的方式需要去实现2个分配资源的接口函数 */</span></span><br><span class="line">    vTaskStartScheduler();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 初始化HAL库函数必须要调用此函数</span></span><br><span class="line">    HAL_Init();</span><br><span class="line">    <span class="comment">// 系统时钟即AHB/APB时钟配置</span></span><br><span class="line">    SystemClock_Config();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化LED</span></span><br><span class="line">    LedGpioInit();</span><br><span class="line">    KeyInit();</span><br><span class="line">    FreeRTOS_Start();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @description: 启动任务：用来创建其他Task</span></span><br><span class="line"><span class="comment"> * @param &#123;void&#125; *pvParameters</span></span><br><span class="line"><span class="comment"> * @return &#123;*&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">start_task</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* 进入临界区:保护临界区里的代码不会被打断 */</span></span><br><span class="line">    taskENTER_CRITICAL();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 使用静态创建3个任务 */</span></span><br><span class="line">    task1_handle = xTaskCreateStatic(</span><br><span class="line">        (TaskFunction_t)task1,</span><br><span class="line">        (<span class="type">char</span> *)<span class="string">&quot;task1&quot;</span>,</span><br><span class="line">        (configSTACK_DEPTH_TYPE)TASK1_STACK,</span><br><span class="line">        (<span class="type">void</span> *)<span class="literal">NULL</span>,</span><br><span class="line">        (UBaseType_t)TASK1_PRIORITY,</span><br><span class="line">        (StackType_t *)task1_stack, <span class="comment">// 我们创建的任务栈（数组存储）的地址</span></span><br><span class="line">        (StaticTask_t *)&amp;task1_tcb  <span class="comment">// 我们创建的tcb的地址</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    task2_handle = xTaskCreateStatic(</span><br><span class="line">        (TaskFunction_t)task2,</span><br><span class="line">        (<span class="type">char</span> *)<span class="string">&quot;task2&quot;</span>,</span><br><span class="line">        (configSTACK_DEPTH_TYPE)TASK2_STACK,</span><br><span class="line">        (<span class="type">void</span> *)<span class="literal">NULL</span>,</span><br><span class="line">        (UBaseType_t)TASK2_PRIORITY,</span><br><span class="line">        (StackType_t *)task2_stack, <span class="comment">// 我们创建的任务栈（数组存储）的地址</span></span><br><span class="line">        (StaticTask_t *)&amp;task2_tcb  <span class="comment">// 我们创建的tcb的地址</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    task3_handle = xTaskCreateStatic(</span><br><span class="line">        (TaskFunction_t)task3,</span><br><span class="line">        (<span class="type">char</span> *)<span class="string">&quot;task3&quot;</span>,</span><br><span class="line">        (configSTACK_DEPTH_TYPE)TASK3_STACK,</span><br><span class="line">        (<span class="type">void</span> *)<span class="literal">NULL</span>,</span><br><span class="line">        (UBaseType_t)TASK3_PRIORITY,</span><br><span class="line">        (StackType_t *)task3_stack, <span class="comment">// 我们创建的任务栈（数组存储）的地址</span></span><br><span class="line">        (StaticTask_t *)&amp;task3_tcb  <span class="comment">// 我们创建的tcb的地址</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 启动任务只需要执行一次即可，用完就删除自己 */</span></span><br><span class="line">    vTaskDelete(<span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 退出临界区 */</span></span><br><span class="line">    taskEXIT_CRITICAL();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">task1</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        LED_TOGGLE(LED0_GPIO_PORT,LED0_GPIO_PIN);</span><br><span class="line">        vTaskDelay(<span class="number">500</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">task2</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        LED_TOGGLE(LED1_GPIO_PORT,LED1_GPIO_PIN);</span><br><span class="line">        vTaskDelay(<span class="number">500</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">task3</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(KeyScan() == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(task1_handle != <span class="literal">NULL</span>) vTaskDelete(task1_handle);</span><br><span class="line">            task1_handle = <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    vTaskDelay(<span class="number">500</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3、任务挂起与回复"><a href="#3、任务挂起与回复" class="headerlink" title="3、任务挂起与回复"></a>3、任务挂起与回复</h3><h4 id="3-1、任务挂起"><a href="#3-1、任务挂起" class="headerlink" title="3.1、任务挂起"></a>3.1、任务挂起</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*传入参数为任务句柄，若传入NULL，则代表挂起当前任务*/</span></span><br><span class="line">vTaskSuspend(task1_handle);</span><br></pre></td></tr></table></figure>

<h4 id="3-2-任务恢复"><a href="#3-2-任务恢复" class="headerlink" title="3.2 任务恢复"></a>3.2 任务恢复</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 任务恢复，传入参数为任务句柄*/</span></span><br><span class="line">vTaskResume(task1_handle);</span><br></pre></td></tr></table></figure>

<h4 id="3-3-挂起任务调度器"><a href="#3-3-挂起任务调度器" class="headerlink" title="3.3 挂起任务调度器"></a>3.3 挂起任务调度器</h4><p>仅执行当前任务</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vTaskSuspendAll();</span><br></pre></td></tr></table></figure>

<h4 id="3-4-恢复任务调度器"><a href="#3-4-恢复任务调度器" class="headerlink" title="3.4 恢复任务调度器"></a>3.4 恢复任务调度器</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xTaskResumeAll();</span><br></pre></td></tr></table></figure>

<h4 id="3-5-打印任务状态"><a href="#3-5-打印任务状态" class="headerlink" title="3.5 打印任务状态"></a>3.5 打印任务状态</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 传入参数为字符串 */</span></span><br><span class="line">vTaskList(str);</span><br></pre></td></tr></table></figure>

<h4 id="3-6-中断管理"><a href="#3-6-中断管理" class="headerlink" title="3.6 中断管理"></a>3.6 中断管理</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*执行此函数后，在中断优先级阈值以下的中断将被屏蔽*/</span></span><br><span class="line">portDISABLE_INTERRUPTS();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 使能中断 */</span></span><br><span class="line">portENABLE_INTERRUPTS();</span><br></pre></td></tr></table></figure>

<img src="/MCU%E5%BC%80%E5%8F%91/FreeRTOS%E5%AD%A6%E4%B9%A0/image-20250130200006595.png" style="zoom:80%;">

<h3 id="5、时间函数"><a href="#5、时间函数" class="headerlink" title="5、时间函数"></a>5、时间函数</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 相对延时，每隔n个时间片执行一次代码，不能保证代码执行时间相同 */</span></span><br><span class="line">vtaskDelay(n);</span><br><span class="line"><span class="comment">/* 绝对延时，代码整体执行时间为n个时间片，保证代码执行周期*/</span></span><br><span class="line">xTaskDelayUntil();</span><br></pre></td></tr></table></figure>

<h3 id="6、任务之间通过队列传输数据"><a href="#6、任务之间通过队列传输数据" class="headerlink" title="6、任务之间通过队列传输数据"></a>6、任务之间通过队列传输数据</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;driver_led.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;driver_key.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;driver_uart.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">StartTask</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Task1</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Task2</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeRTOS_Start</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 初始化HAL库函数必须要调用此函数</span></span><br><span class="line">    HAL_Init();</span><br><span class="line">    <span class="comment">// 系统时钟即AHB/APB时钟配置</span></span><br><span class="line">    SystemClock_Config();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化LED</span></span><br><span class="line">    LedInit();</span><br><span class="line">    KeyInit();</span><br><span class="line">    UartInit(<span class="number">115200</span>);</span><br><span class="line">    FreeRTOS_Start();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        HAL_Delay(<span class="number">1000</span>);</span><br><span class="line">        UartSendData(<span class="string">&quot;hello\r\n&quot;</span>);</span><br><span class="line">        LED_TOGGLE(LED0_GPIO_PORT,LED0_GPIO_PIN);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 任务句柄，用以保存不同任务的配置 */</span></span><br><span class="line">TaskHandle_t start_task_handle;</span><br><span class="line">TaskHandle_t task1_handle;</span><br><span class="line">TaskHandle_t task2_handle;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：常规写法，起始任务，用以创建其他任务</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeRTOS_Start</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    StartTask,              <span class="comment">//任务函数的地址          </span></span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;StartTask&quot;</span>,            <span class="comment">//任务函数的名称</span></span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,                    <span class="comment">//任务函数栈空间大小</span></span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,                   <span class="comment">//任务函数的参数</span></span><br><span class="line">        (UBaseType_t)       <span class="number">1</span>,                      <span class="comment">//任务函数的优先级</span></span><br><span class="line">        (TaskHandle_t*)     &amp;start_task_handle      <span class="comment">//任务函数的句柄</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 启用调度器，负责任务切换*/</span></span><br><span class="line">    vTaskStartScheduler();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 队列句柄*/</span></span><br><span class="line">QueueHandle_t handle1;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">StartTask</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* 创建一个队列 */</span></span><br><span class="line">    handle1 = xQueueCreate(<span class="number">1</span>,<span class="keyword">sizeof</span>(<span class="type">char</span> *));</span><br><span class="line">    <span class="keyword">if</span>(handle1 == <span class="literal">NULL</span>) UartSendData(<span class="string">&quot;task err&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 进入临界保护区，保证在临界区的代码不会被打断*/</span></span><br><span class="line">    taskENTER_CRITICAL();</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    Task1,</span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;Task1&quot;</span>,</span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,</span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,</span><br><span class="line">        (UBaseType_t)       <span class="number">2</span>,</span><br><span class="line">        (TaskHandle_t*)     &amp;task1_handle</span><br><span class="line">    );</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    Task2,</span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;Task2&quot;</span>,</span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,</span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,</span><br><span class="line">        (UBaseType_t)       <span class="number">4</span>,</span><br><span class="line">        (TaskHandle_t*)     &amp;task2_handle</span><br><span class="line">    );</span><br><span class="line">    vTaskDelete(<span class="literal">NULL</span>);  <span class="comment">//删除任务本身</span></span><br><span class="line">    <span class="comment">/* 退出临界保护区*/</span></span><br><span class="line">    taskEXIT_CRITICAL();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：负责创建一个字符串，通过队列发送出去</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Task1</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span>* str = <span class="string">&quot;tehsjncncncncc&quot;</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(KeyScan() == KEY0)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">/* 往队列插入一个值，并设置阻塞等待*/</span></span><br><span class="line">            xQueueSend(handle1,&amp;str,portMAX_DELAY);</span><br><span class="line">            UartSendData(<span class="string">&quot;Send Pass\r\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        vTaskDelay(<span class="number">20</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：接收数据任务</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Task2</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *buffer;</span><br><span class="line">    BaseType_t res;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/* 接收队列的任务，并进入阻塞等待*/</span></span><br><span class="line">        res = xQueueReceive(handle1,&amp;buffer,portMAX_DELAY);</span><br><span class="line">        <span class="keyword">if</span>(res == pdPASS) </span><br><span class="line">        &#123;</span><br><span class="line">            UartSendData(<span class="string">&quot;buffer：\r\n&quot;</span>);</span><br><span class="line">            UartSendData(buffer);</span><br><span class="line">            UartSendData(<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        vTaskDelay(<span class="number">500</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7、二进制信号量释放与接收"><a href="#7、二进制信号量释放与接收" class="headerlink" title="7、二进制信号量释放与接收"></a>7、二进制信号量释放与接收</h3><h4 id="7-1-二进制信号量"><a href="#7-1-二进制信号量" class="headerlink" title="7.1 二进制信号量"></a>7.1 二进制信号量</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">StartTask</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Task1</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Task2</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeRTOS_Start</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 初始化HAL库函数必须要调用此函数</span></span><br><span class="line">    HAL_Init();</span><br><span class="line">    <span class="comment">// 系统时钟即AHB/APB时钟配置</span></span><br><span class="line">    SystemClock_Config();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化LED</span></span><br><span class="line">    LedInit();</span><br><span class="line">    KeyInit();</span><br><span class="line">    UartInit(<span class="number">115200</span>);</span><br><span class="line">    FreeRTOS_Start();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        HAL_Delay(<span class="number">1000</span>);</span><br><span class="line">        UartSendData(<span class="string">&quot;hello\r\n&quot;</span>);</span><br><span class="line">        LED_TOGGLE(LED0_GPIO_PORT,LED0_GPIO_PIN);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 任务句柄，用以保存不同任务的配置 */</span></span><br><span class="line">TaskHandle_t start_task_handle;</span><br><span class="line">TaskHandle_t task1_handle;</span><br><span class="line">TaskHandle_t task2_handle;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：常规写法，起始任务，用以创建其他任务</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeRTOS_Start</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    StartTask,              <span class="comment">//任务函数的地址          </span></span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;StartTask&quot;</span>,            <span class="comment">//任务函数的名称</span></span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,                    <span class="comment">//任务函数栈空间大小</span></span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,                   <span class="comment">//任务函数的参数</span></span><br><span class="line">        (UBaseType_t)       <span class="number">1</span>,                      <span class="comment">//任务函数的优先级</span></span><br><span class="line">        (TaskHandle_t*)     &amp;start_task_handle      <span class="comment">//任务函数的句柄</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 启用调度器，负责任务切换*/</span></span><br><span class="line">    vTaskStartScheduler();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 队列句柄*/</span></span><br><span class="line">QueueHandle_t handle1;</span><br><span class="line">SemaphoreHandle_t semaphore_handle;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">StartTask</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* 创建一个信号量 */</span></span><br><span class="line">    vSemaphoreCreateBinary(semaphore_handle);</span><br><span class="line">    <span class="keyword">if</span>(semaphore_handle != <span class="literal">NULL</span>) UartSendData(<span class="string">&quot;Create success!\r\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 创建一个队列 */</span></span><br><span class="line">    handle1 = xQueueCreate(<span class="number">1</span>,<span class="keyword">sizeof</span>(<span class="type">char</span> *));</span><br><span class="line">    <span class="keyword">if</span>(handle1 == <span class="literal">NULL</span>) UartSendData(<span class="string">&quot;task err&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 进入临界保护区，保证在临界区的代码不会被打断*/</span></span><br><span class="line">    taskENTER_CRITICAL();</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    Task1,</span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;Task1&quot;</span>,</span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,</span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,</span><br><span class="line">        (UBaseType_t)       <span class="number">2</span>,</span><br><span class="line">        (TaskHandle_t*)     &amp;task1_handle</span><br><span class="line">    );</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    Task2,</span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;Task2&quot;</span>,</span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,</span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,</span><br><span class="line">        (UBaseType_t)       <span class="number">4</span>,</span><br><span class="line">        (TaskHandle_t*)     &amp;task2_handle</span><br><span class="line">    );</span><br><span class="line">    vTaskDelete(<span class="literal">NULL</span>);  <span class="comment">//删除任务本身</span></span><br><span class="line">    <span class="comment">/* 退出临界保护区*/</span></span><br><span class="line">    taskEXIT_CRITICAL();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：释放信号量</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Task1</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    BaseType_t res;   </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(KeyScan() == KEY0)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">/* 释放信号量 */</span></span><br><span class="line">            res = xSemaphoreGive(semaphore_handle);</span><br><span class="line">            <span class="keyword">if</span> (res == pdPASS) UartSendData(<span class="string">&quot;Send Pass\r\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        vTaskDelay(<span class="number">20</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：接收信号量</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Task2</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    BaseType_t res;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/* 接收信号量是否释放 */</span></span><br><span class="line">        res = xSemaphoreTake(semaphore_handle, portMAX_DELAY);</span><br><span class="line">        <span class="keyword">if</span>(res == pdPASS) </span><br><span class="line">        &#123;</span><br><span class="line">            UartSendData(<span class="string">&quot;Take success!\r\n&quot;</span>);</span><br><span class="line">            UartSendData(<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        vTaskDelay(<span class="number">500</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="7-2-互斥二进制信号量"><a href="#7-2-互斥二进制信号量" class="headerlink" title="7.2 互斥二进制信号量"></a>7.2 互斥二进制信号量</h4><p>它会将阻塞高优先级的低优先级提升，从而保证高优先级不会被低优先级阻塞。</p>
<h3 id="8、计数信号量释放与接收"><a href="#8、计数信号量释放与接收" class="headerlink" title="8、计数信号量释放与接收"></a>8、计数信号量释放与接收</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">StartTask</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Task1</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Task2</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeRTOS_Start</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 初始化HAL库函数必须要调用此函数</span></span><br><span class="line">    HAL_Init();</span><br><span class="line">    <span class="comment">// 系统时钟即AHB/APB时钟配置</span></span><br><span class="line">    SystemClock_Config();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化LED</span></span><br><span class="line">    LedInit();</span><br><span class="line">    KeyInit();</span><br><span class="line">    UartInit(<span class="number">115200</span>);</span><br><span class="line">    FreeRTOS_Start();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        HAL_Delay(<span class="number">1000</span>);</span><br><span class="line">        UartSendData(<span class="string">&quot;hello\r\n&quot;</span>);</span><br><span class="line">        LED_TOGGLE(LED0_GPIO_PORT,LED0_GPIO_PIN);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 任务句柄，用以保存不同任务的配置 */</span></span><br><span class="line">TaskHandle_t start_task_handle;</span><br><span class="line">TaskHandle_t task1_handle;</span><br><span class="line">TaskHandle_t task2_handle;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：常规写法，起始任务，用以创建其他任务</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeRTOS_Start</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    StartTask,              <span class="comment">//任务函数的地址          </span></span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;StartTask&quot;</span>,            <span class="comment">//任务函数的名称</span></span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,                    <span class="comment">//任务函数栈空间大小</span></span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,                   <span class="comment">//任务函数的参数</span></span><br><span class="line">        (UBaseType_t)       <span class="number">1</span>,                      <span class="comment">//任务函数的优先级</span></span><br><span class="line">        (TaskHandle_t*)     &amp;start_task_handle      <span class="comment">//任务函数的句柄</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 启用调度器，负责任务切换*/</span></span><br><span class="line">    vTaskStartScheduler();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> str[<span class="number">100</span>];</span><br><span class="line"><span class="comment">/* 队列句柄*/</span></span><br><span class="line">QueueHandle_t handle1;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">StartTask</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    UBaseType_t Count = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">/* 创建一个信号量 */</span></span><br><span class="line">    handle1 = xSemaphoreCreateCounting(<span class="number">100</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(!(handle1 == <span class="literal">NULL</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        UartSendData(<span class="string">&quot;Create success!\r\n&quot;</span>);</span><br><span class="line">        Count = uxSemaphoreGetCount(handle1);</span><br><span class="line">        <span class="built_in">sprintf</span>(str, <span class="string">&quot;the init count: %d&quot;</span>, Count);</span><br><span class="line">        UartSendData(str);</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 进入临界保护区，保证在临界区的代码不会被打断*/</span></span><br><span class="line">    taskENTER_CRITICAL();</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    Task1,</span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;Task1&quot;</span>,</span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,</span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,</span><br><span class="line">        (UBaseType_t)       <span class="number">3</span>,</span><br><span class="line">        (TaskHandle_t*)     &amp;task1_handle</span><br><span class="line">    );</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    Task2,</span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;Task2&quot;</span>,</span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,</span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,</span><br><span class="line">        (UBaseType_t)       <span class="number">4</span>,</span><br><span class="line">        (TaskHandle_t*)     &amp;task2_handle</span><br><span class="line">    );</span><br><span class="line">    vTaskDelete(<span class="literal">NULL</span>);  <span class="comment">//删除任务本身</span></span><br><span class="line">    <span class="comment">/* 退出临界保护区*/</span></span><br><span class="line">    taskEXIT_CRITICAL();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：释放信号量</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Task1</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    BaseType_t res;   </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(KeyScan() == KEY0)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">/* 释放信号量 */</span></span><br><span class="line">            res = xSemaphoreGive(handle1);</span><br><span class="line">            <span class="keyword">if</span> (res == pdPASS) UartSendData(<span class="string">&quot;Send Pass\r\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        vTaskDelay(<span class="number">20</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：接收信号量</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Task2</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> str[<span class="number">100</span>];</span><br><span class="line">    UBaseType_t Count = <span class="number">0</span>;</span><br><span class="line">    BaseType_t res;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/* 接收信号量是否释放 */</span></span><br><span class="line">        res = xSemaphoreTake(handle1, portMAX_DELAY);</span><br><span class="line">        <span class="keyword">if</span>(res == pdPASS) </span><br><span class="line">        &#123;</span><br><span class="line">           UartSendData(<span class="string">&quot;Take success!\r\n&quot;</span>);</span><br><span class="line">           UartSendData(<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">           UartSendData(str);</span><br><span class="line">        &#125;</span><br><span class="line">        Count = uxSemaphoreGetCount(handle1);</span><br><span class="line">        <span class="built_in">sprintf</span>(str, <span class="string">&quot;the init count: %d\r\n&quot;</span>, Count);</span><br><span class="line">        UartSendData(str);</span><br><span class="line">        vTaskDelay(<span class="number">1000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="9、队列集"><a href="#9、队列集" class="headerlink" title="9、队列集"></a>9、队列集</h3><h3 id="10、事件标志组"><a href="#10、事件标志组" class="headerlink" title="10、事件标志组"></a>10、事件标志组</h3><p>比信号量更灵活，每一个bit位都代表一个信号量。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">StartTask</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Task1</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Task2</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeRTOS_Start</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 初始化HAL库函数必须要调用此函数</span></span><br><span class="line">    HAL_Init();</span><br><span class="line">    <span class="comment">// 系统时钟即AHB/APB时钟配置</span></span><br><span class="line">    SystemClock_Config();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化LED</span></span><br><span class="line">    LedInit();</span><br><span class="line">    KeyInit();</span><br><span class="line">    UartInit(<span class="number">115200</span>);</span><br><span class="line">    FreeRTOS_Start();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        HAL_Delay(<span class="number">1000</span>);</span><br><span class="line">        UartSendData(<span class="string">&quot;hello\r\n&quot;</span>);</span><br><span class="line">        LED_TOGGLE(LED0_GPIO_PORT,LED0_GPIO_PIN);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 任务句柄，用以保存不同任务的配置 */</span></span><br><span class="line">TaskHandle_t start_task_handle;</span><br><span class="line">TaskHandle_t task1_handle;</span><br><span class="line">TaskHandle_t task2_handle;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：常规写法，起始任务，用以创建其他任务</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeRTOS_Start</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    StartTask,              <span class="comment">//任务函数的地址          </span></span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;StartTask&quot;</span>,            <span class="comment">//任务函数的名称</span></span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,                    <span class="comment">//任务函数栈空间大小</span></span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,                   <span class="comment">//任务函数的参数</span></span><br><span class="line">        (UBaseType_t)       <span class="number">1</span>,                      <span class="comment">//任务函数的优先级</span></span><br><span class="line">        (TaskHandle_t*)     &amp;start_task_handle      <span class="comment">//任务函数的句柄</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 启用调度器，负责任务切换*/</span></span><br><span class="line">    vTaskStartScheduler();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> str[<span class="number">100</span>];</span><br><span class="line">EventGroupHandle_t event_handle;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">StartTask</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    UBaseType_t Count = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">/* 创建一个信号量 */</span></span><br><span class="line">    event_handle = xEventGroupCreate();</span><br><span class="line">    <span class="keyword">if</span>(!(event_handle == <span class="literal">NULL</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        UartSendData(<span class="string">&quot;Create success!\r\n&quot;</span>);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">/* 进入临界保护区，保证在临界区的代码不会被打断*/</span></span><br><span class="line">    taskENTER_CRITICAL();</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    Task1,</span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;Task1&quot;</span>,</span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,</span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,</span><br><span class="line">        (UBaseType_t)       <span class="number">3</span>,</span><br><span class="line">        (TaskHandle_t*)     &amp;task1_handle</span><br><span class="line">    );</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    Task2,</span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;Task2&quot;</span>,</span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,</span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,</span><br><span class="line">        (UBaseType_t)       <span class="number">4</span>,</span><br><span class="line">        (TaskHandle_t*)     &amp;task2_handle</span><br><span class="line">    );</span><br><span class="line">    vTaskDelete(<span class="literal">NULL</span>);  <span class="comment">//删除任务本身</span></span><br><span class="line">    <span class="comment">/* 退出临界保护区*/</span></span><br><span class="line">    taskEXIT_CRITICAL();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：发送事件</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> EVENTBIT_0 (1 &lt;&lt; 0)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> EVENTBIT_1 (1 &lt;&lt; 1)</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Task1</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    EventBits_t res;   </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        xEventGroupSetBits(event_handle, <span class="number">1</span>&lt;&lt;<span class="number">3</span>);</span><br><span class="line">        <span class="keyword">if</span>(KeyScan() == KEY0)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">/* 设置标志位*/</span></span><br><span class="line">            res = xEventGroupSetBits(event_handle, EVENTBIT_0);</span><br><span class="line">            <span class="built_in">sprintf</span>(str,<span class="string">&quot;event flag: %#x\r\n&quot;</span>, res);</span><br><span class="line">            UartSendData(str);</span><br><span class="line">            res = xEventGroupSetBits(event_handle, EVENTBIT_1);</span><br><span class="line">            <span class="built_in">sprintf</span>(str,<span class="string">&quot;event flag: %#x\r\n&quot;</span>, res);</span><br><span class="line">            UartSendData(str);</span><br><span class="line"></span><br><span class="line">            UartSendData(<span class="string">&quot;KEY0 PRESS!\r\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        vTaskDelay(<span class="number">20</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：接收事件</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Task2</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    EventBits_t res;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/* 接收信号量是否释放 */</span></span><br><span class="line">        res = xEventGroupWaitBits(</span><br><span class="line">            event_handle,                <span class="comment">// 事件句柄</span></span><br><span class="line">            ((EVENTBIT_0 | EVENTBIT_1)), <span class="comment">// 等待的标志位</span></span><br><span class="line">            pdTRUE,                      <span class="comment">// 是否清楚标志位</span></span><br><span class="line">            pdTRUE,                      <span class="comment">// 是否等待标志位</span></span><br><span class="line">            portMAX_DELAY                <span class="comment">// 等待事件</span></span><br><span class="line">        );</span><br><span class="line">        <span class="built_in">sprintf</span>(str, <span class="string">&quot;task2: %x\r\n&quot;</span>, res);</span><br><span class="line">        UartSendData(str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="11-任务通知"><a href="#11-任务通知" class="headerlink" title="11 任务通知"></a>11 任务通知</h3><h4 id="11-1-任务通知模拟信号量"><a href="#11-1-任务通知模拟信号量" class="headerlink" title="11.1 任务通知模拟信号量"></a>11.1 任务通知模拟信号量</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;portmacro.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;projdefs.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">StartTask</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Task1</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Task2</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeRTOS_Start</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 初始化HAL库函数必须要调用此函数</span></span><br><span class="line">    HAL_Init();</span><br><span class="line">    <span class="comment">// 系统时钟即AHB/APB时钟配置</span></span><br><span class="line">    SystemClock_Config();</span><br><span class="line">    <span class="comment">// 初始化LED</span></span><br><span class="line">    LedInit();</span><br><span class="line">    KeyInit();</span><br><span class="line">    UartInit(<span class="number">115200</span>);</span><br><span class="line">    FreeRTOS_Start();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        HAL_Delay(<span class="number">1000</span>);</span><br><span class="line">        UartSendData(<span class="string">&quot;hello\r\n&quot;</span>);</span><br><span class="line">        LED_TOGGLE(LED0_GPIO_PORT,LED0_GPIO_PIN);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 任务句柄，用以保存不同任务的配置 */</span></span><br><span class="line">TaskHandle_t start_task_handle;</span><br><span class="line">TaskHandle_t task1_handle;</span><br><span class="line">TaskHandle_t task2_handle;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：常规写法，起始任务，用以创建其他任务</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeRTOS_Start</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    StartTask,              <span class="comment">//任务函数的地址          </span></span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;StartTask&quot;</span>,            <span class="comment">//任务函数的名称</span></span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,                    <span class="comment">//任务函数栈空间大小</span></span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,                   <span class="comment">//任务函数的参数</span></span><br><span class="line">        (UBaseType_t)       <span class="number">1</span>,                      <span class="comment">//任务函数的优先级</span></span><br><span class="line">        (TaskHandle_t*)     &amp;start_task_handle      <span class="comment">//任务函数的句柄</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 启用调度器，负责任务切换*/</span></span><br><span class="line">    vTaskStartScheduler();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> str[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">StartTask</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* 进入临界保护区，保证在临界区的代码不会被打断*/</span></span><br><span class="line">    taskENTER_CRITICAL();</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    Task1,</span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;Task1&quot;</span>,</span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,</span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,</span><br><span class="line">        (UBaseType_t)       <span class="number">3</span>,</span><br><span class="line">        (TaskHandle_t*)     &amp;task1_handle</span><br><span class="line">    );</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    Task2,</span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;Task2&quot;</span>,</span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,</span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,</span><br><span class="line">        (UBaseType_t)       <span class="number">4</span>,</span><br><span class="line">        (TaskHandle_t*)     &amp;task2_handle</span><br><span class="line">    );</span><br><span class="line">    vTaskDelete(<span class="literal">NULL</span>);  <span class="comment">//删除任务本身</span></span><br><span class="line">    <span class="comment">/* 退出临界保护区*/</span></span><br><span class="line">    taskEXIT_CRITICAL();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：任务通知发送</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Task1</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    EventBits_t res;   </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(KeyScan() == KEY0)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">/* 实际使取出task2的通知值，然后＋1*/</span></span><br><span class="line">            xTaskNotifyGive(task2_handle); </span><br><span class="line">            UartSendData(<span class="string">&quot;KEY0 PRESS!\r\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        vTaskDelay(<span class="number">200</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：任务通知接收</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Task2</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> res_notify;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123; </span><br><span class="line">        res_notify = ulTaskNotifyTake(</span><br><span class="line">            pdTRUE,             <span class="comment">//接收完通知后，是否对通知值处理，pdTRUE:置0；pdFALSE:-1</span></span><br><span class="line">            portMAX_DELAY       <span class="comment">//设置等待时间</span></span><br><span class="line">        );</span><br><span class="line">        <span class="built_in">sprintf</span>(str, <span class="string">&quot;task2 notify: %d\r\n&quot;</span>, res_notify);</span><br><span class="line">        UartSendData(str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="11-2-任务通知模拟消息队列（邮箱）"><a href="#11-2-任务通知模拟消息队列（邮箱）" class="headerlink" title="11.2 任务通知模拟消息队列（邮箱）"></a>11.2 任务通知模拟消息队列（邮箱）</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;portmacro.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;projdefs.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">StartTask</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Task1</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Task2</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeRTOS_Start</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 初始化HAL库函数必须要调用此函数</span></span><br><span class="line">    HAL_Init();</span><br><span class="line">    <span class="comment">// 系统时钟即AHB/APB时钟配置</span></span><br><span class="line">    SystemClock_Config();</span><br><span class="line">    <span class="comment">// 初始化LED</span></span><br><span class="line">    LedInit();</span><br><span class="line">    KeyInit();</span><br><span class="line">    UartInit(<span class="number">115200</span>);</span><br><span class="line">    FreeRTOS_Start();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        HAL_Delay(<span class="number">1000</span>);</span><br><span class="line">        UartSendData(<span class="string">&quot;hello\r\n&quot;</span>);</span><br><span class="line">        LED_TOGGLE(LED0_GPIO_PORT,LED0_GPIO_PIN);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 任务句柄，用以保存不同任务的配置 */</span></span><br><span class="line">TaskHandle_t start_task_handle;</span><br><span class="line">TaskHandle_t task1_handle;</span><br><span class="line">TaskHandle_t task2_handle;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：常规写法，起始任务，用以创建其他任务</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeRTOS_Start</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    StartTask,              <span class="comment">//任务函数的地址          </span></span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;StartTask&quot;</span>,            <span class="comment">//任务函数的名称</span></span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,                    <span class="comment">//任务函数栈空间大小</span></span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,                   <span class="comment">//任务函数的参数</span></span><br><span class="line">        (UBaseType_t)       <span class="number">1</span>,                      <span class="comment">//任务函数的优先级</span></span><br><span class="line">        (TaskHandle_t*)     &amp;start_task_handle      <span class="comment">//任务函数的句柄</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 启用调度器，负责任务切换*/</span></span><br><span class="line">    vTaskStartScheduler();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> str[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">StartTask</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* 进入临界保护区，保证在临界区的代码不会被打断*/</span></span><br><span class="line">    taskENTER_CRITICAL();</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    Task1,</span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;Task1&quot;</span>,</span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,</span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,</span><br><span class="line">        (UBaseType_t)       <span class="number">3</span>,</span><br><span class="line">        (TaskHandle_t*)     &amp;task1_handle</span><br><span class="line">    );</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    Task2,</span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;Task2&quot;</span>,</span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,</span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,</span><br><span class="line">        (UBaseType_t)       <span class="number">4</span>,</span><br><span class="line">        (TaskHandle_t*)     &amp;task2_handle</span><br><span class="line">    );</span><br><span class="line">    vTaskDelete(<span class="literal">NULL</span>);  <span class="comment">//删除任务本身</span></span><br><span class="line">    <span class="comment">/* 退出临界保护区*/</span></span><br><span class="line">    taskEXIT_CRITICAL();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：模拟消息队列发送</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Task1</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    EventBits_t res;   </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(KeyScan() == KEY0)</span><br><span class="line">        &#123;</span><br><span class="line">            xTaskNotify(task2_handle,          <span class="comment">// 要发送的任务句柄</span></span><br><span class="line">                        <span class="number">100</span>,                   <span class="comment">// 要发送的数据</span></span><br><span class="line">                        eSetValueWithOverwrite <span class="comment">// 发送方式</span></span><br><span class="line">            );</span><br><span class="line">            UartSendData(<span class="string">&quot;KEY0 PRESS!\r\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        vTaskDelay(<span class="number">200</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：模拟消息队列接收</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Task2</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> res_notify;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      xTaskNotifyWait(</span><br><span class="line">          <span class="number">0x00000000</span>,   <span class="comment">// 接收通知前是否清楚通知值，按位，全为0表示不不清楚</span></span><br><span class="line">          <span class="number">0xffffffff</span>,   <span class="comment">// 接收通知后是否要清楚通知值，按位，全为f表示清楚</span></span><br><span class="line">          &amp;res_notify,  <span class="comment">// 接受值存放地址</span></span><br><span class="line">          portMAX_DELAY <span class="comment">// 等待事件</span></span><br><span class="line">      );</span><br><span class="line">      <span class="built_in">sprintf</span>(str, <span class="string">&quot;task2 notify: %d\r\n&quot;</span>, res_notify);</span><br><span class="line">      UartSendData(str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="11-3-模拟事件标志组"><a href="#11-3-模拟事件标志组" class="headerlink" title="11.3 模拟事件标志组"></a>11.3 模拟事件标志组</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;portmacro.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;projdefs.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">StartTask</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Task1</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Task2</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeRTOS_Start</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 初始化HAL库函数必须要调用此函数</span></span><br><span class="line">    HAL_Init();</span><br><span class="line">    <span class="comment">// 系统时钟即AHB/APB时钟配置</span></span><br><span class="line">    SystemClock_Config();</span><br><span class="line">    <span class="comment">// 初始化LED</span></span><br><span class="line">    LedInit();</span><br><span class="line">    KeyInit();</span><br><span class="line">    UartInit(<span class="number">115200</span>);</span><br><span class="line">    FreeRTOS_Start();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        HAL_Delay(<span class="number">1000</span>);</span><br><span class="line">        UartSendData(<span class="string">&quot;hello\r\n&quot;</span>);</span><br><span class="line">        LED_TOGGLE(LED0_GPIO_PORT,LED0_GPIO_PIN);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 任务句柄，用以保存不同任务的配置 */</span></span><br><span class="line">TaskHandle_t start_task_handle;</span><br><span class="line">TaskHandle_t task1_handle;</span><br><span class="line">TaskHandle_t task2_handle;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：常规写法，起始任务，用以创建其他任务</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeRTOS_Start</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    StartTask,              <span class="comment">//任务函数的地址          </span></span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;StartTask&quot;</span>,            <span class="comment">//任务函数的名称</span></span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,                    <span class="comment">//任务函数栈空间大小</span></span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,                   <span class="comment">//任务函数的参数</span></span><br><span class="line">        (UBaseType_t)       <span class="number">1</span>,                      <span class="comment">//任务函数的优先级</span></span><br><span class="line">        (TaskHandle_t*)     &amp;start_task_handle      <span class="comment">//任务函数的句柄</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 启用调度器，负责任务切换*/</span></span><br><span class="line">    vTaskStartScheduler();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> str[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">StartTask</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* 进入临界保护区，保证在临界区的代码不会被打断*/</span></span><br><span class="line">    taskENTER_CRITICAL();</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    Task1,</span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;Task1&quot;</span>,</span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,</span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,</span><br><span class="line">        (UBaseType_t)       <span class="number">3</span>,</span><br><span class="line">        (TaskHandle_t*)     &amp;task1_handle</span><br><span class="line">    );</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    Task2,</span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;Task2&quot;</span>,</span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,</span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,</span><br><span class="line">        (UBaseType_t)       <span class="number">4</span>,</span><br><span class="line">        (TaskHandle_t*)     &amp;task2_handle</span><br><span class="line">    );</span><br><span class="line">    vTaskDelete(<span class="literal">NULL</span>);  <span class="comment">//删除任务本身</span></span><br><span class="line">    <span class="comment">/* 退出临界保护区*/</span></span><br><span class="line">    taskEXIT_CRITICAL();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：模拟事件标志组发送</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Task1</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    EventBits_t res;   </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> (KeyScan() == KEY0) &#123;</span><br><span class="line">        xTaskNotify(task2_handle, <span class="comment">// 要发送的任务句柄</span></span><br><span class="line">                    <span class="number">1</span> &lt;&lt; <span class="number">8</span>,       <span class="comment">// 要发送的数据位</span></span><br><span class="line">                    eSetBits      <span class="comment">// 发送方式</span></span><br><span class="line">        );</span><br><span class="line">        UartSendData(<span class="string">&quot;KEY0 PRESS!\r\n&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">        vTaskDelay(<span class="number">200</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：模拟事件标志组接收</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Task2</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> res_notify;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">      xTaskNotifyWait(</span><br><span class="line">          <span class="number">0x00000000</span>,   <span class="comment">// 接收通知前是否清楚通知值，按位，全为0表示不不清楚</span></span><br><span class="line">          <span class="number">0xffffffff</span>,   <span class="comment">// 接收通知后是否要清楚通知值，按位，全为f表示清楚</span></span><br><span class="line">          &amp;res_notify,  <span class="comment">// 接受值存放地址</span></span><br><span class="line">          portMAX_DELAY <span class="comment">// 等待时间</span></span><br><span class="line">      );</span><br><span class="line">      <span class="built_in">sprintf</span>(str, <span class="string">&quot;task2 notify: %0x\r\n&quot;</span>, res_notify);</span><br><span class="line">      UartSendData(str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="12、软件定时器"><a href="#12、软件定时器" class="headerlink" title="12、软件定时器"></a>12、软件定时器</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">StartTask</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Task1</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeRTOS_Start</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 初始化HAL库函数必须要调用此函数</span></span><br><span class="line">    HAL_Init();</span><br><span class="line">    <span class="comment">// 系统时钟即AHB/APB时钟配置</span></span><br><span class="line">    SystemClock_Config();</span><br><span class="line">    <span class="comment">// 初始化LED</span></span><br><span class="line">    LedInit();</span><br><span class="line">    KeyInit();</span><br><span class="line">    UartInit(<span class="number">115200</span>);</span><br><span class="line">    FreeRTOS_Start();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 任务句柄，用以保存不同任务的配置 */</span></span><br><span class="line">TaskHandle_t start_task_handle;</span><br><span class="line">TaskHandle_t task1_handle;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：常规写法，起始任务，用以创建其他任务</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeRTOS_Start</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    xTaskCreate(</span><br><span class="line">        (TaskFunction_t)    StartTask,              <span class="comment">//任务函数的地址          </span></span><br><span class="line">        (<span class="type">char</span> *)            <span class="string">&quot;StartTask&quot;</span>,            <span class="comment">//任务函数的名称</span></span><br><span class="line">        (<span class="type">uint16_t</span>)          <span class="number">128</span>,                    <span class="comment">//任务函数栈空间大小</span></span><br><span class="line">        (<span class="type">void</span> *)            <span class="literal">NULL</span>,                   <span class="comment">//任务函数的参数</span></span><br><span class="line">        (UBaseType_t)       <span class="number">1</span>,                      <span class="comment">//任务函数的优先级</span></span><br><span class="line">        (TaskHandle_t*)     &amp;start_task_handle      <span class="comment">//任务函数的句柄</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 启用调度器，负责任务切换*/</span></span><br><span class="line">    vTaskStartScheduler();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> str[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TimerCallBack_1</span><span class="params">(TimerHandle_t timer)</span>;</span><br><span class="line"></span><br><span class="line">TimerHandle_t timer_handle_1;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：开始任务回调函数</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">StartTask</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* 创建软件定时器，由软件定时器任务（通过定义宏，由系统创建）控制*/</span></span><br><span class="line">    timer_handle_1 = xTimerCreate(<span class="string">&quot;time_1&quot;</span>,       <span class="comment">// 创建名称</span></span><br><span class="line">                                  <span class="number">500</span>,            <span class="comment">// 定时器延迟时间</span></span><br><span class="line">                                  pdTRUE,         <span class="comment">// 是否重载（周期/一次）</span></span><br><span class="line">                                  (<span class="type">void</span> *)<span class="number">1</span>,      <span class="comment">// 定时器唯一ID</span></span><br><span class="line">                                  TimerCallBack_1 <span class="comment">// 定时器回调函数</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 进入临界保护区，保证在临界区的代码不会被打断*/</span></span><br><span class="line">    taskENTER_CRITICAL();</span><br><span class="line">    xTaskCreate((TaskFunction_t)Task1, (<span class="type">char</span> *)<span class="string">&quot;Task1&quot;</span>, (<span class="type">uint16_t</span>)<span class="number">128</span>,</span><br><span class="line">                (<span class="type">void</span> *)<span class="literal">NULL</span>, (UBaseType_t)<span class="number">3</span>, (TaskHandle_t *)&amp;task1_handle);</span><br><span class="line"></span><br><span class="line">    vTaskDelete(<span class="literal">NULL</span>); <span class="comment">// 删除任务本身</span></span><br><span class="line">    <span class="comment">/* 退出临界保护区*/</span></span><br><span class="line">    taskEXIT_CRITICAL();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：开启软件定时器</span></span><br><span class="line"><span class="comment"> * 输入参数：无</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Task1</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    EventBits_t res;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (KeyScan() == KEY0) &#123;</span><br><span class="line">        <span class="comment">/* 开启软件定时器*/</span></span><br><span class="line">        xTimerStart(timer_handle_1, <span class="comment">// 定时器句柄</span></span><br><span class="line">                    portMAX_DELAY); <span class="comment">// 等待时间</span></span><br><span class="line">        UartSendData((<span class="string">&quot;timer start!\r\n&quot;</span>));</span><br><span class="line">      &#125;</span><br><span class="line">        vTaskDelay(<span class="number">200</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数作用：定时器回调函数</span></span><br><span class="line"><span class="comment"> * 输入参数：定时器句柄</span></span><br><span class="line"><span class="comment"> * 返回值：无</span></span><br><span class="line"><span class="comment"> * 作者：LSK</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">TimerCallBack_1</span><span class="params">(TimerHandle_t timer)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(timer == timer_handle_1)</span><br><span class="line">    &#123;</span><br><span class="line">        UartSendData(<span class="string">&quot;Call back!\r\n&quot;</span>);</span><br><span class="line">        LED_TOGGLE(LED0_GPIO_PORT, LED0_GPIO_PIN);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-05-27T16:00:00.000Z" title="2025/5/28 00:00:00">2025-05-28</time>发表</span><span class="level-item"><time dateTime="2025-10-16T17:41:45.000Z" title="2025/10/17 01:41:45">2025-10-17</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Linux/">Linux</a></span><span class="level-item">6 分钟读完 (大约864个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/Linux/ubuntu%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4/">ubuntu使用命令</a></p><div class="content"><ul>
<li>重启</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo reboot</span><br></pre></td></tr></table></figure>

<ul>
<li>关机</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo poweroff</span><br></pre></td></tr></table></figure>

<ul>
<li>返回</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.返回根目录</span><br><span class="line">cd</span><br><span class="line">2.返回上一级</span><br><span class="line">cd ..</span><br><span class="line">3.回到上一次的位置</span><br><span class="line">cd -</span><br></pre></td></tr></table></figure>

<ul>
<li>列出当前目录文件</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">1.显示当前文件目录</span><br><span class="line">ls</span><br><span class="line"></span><br><span class="line">2.显示指定文件目录</span><br><span class="line">ls path</span><br><span class="line"></span><br><span class="line">3.显示所有文件</span><br><span class="line">ls -a</span><br><span class="line"></span><br><span class="line">4.显示文件属性</span><br><span class="line">ls -l</span><br><span class="line"></span><br><span class="line">5.显示所有文件属性</span><br><span class="line">ls -al或者ls -la</span><br></pre></td></tr></table></figure>

<ul>
<li>清楚终端</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clear</span><br></pre></td></tr></table></figure>

<ul>
<li>显示当前路径</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pwd</span><br></pre></td></tr></table></figure>

<ul>
<li>文件操作</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">1.创建文件夹</span><br><span class="line">mkdir document</span><br><span class="line">2.创建多级文件夹</span><br><span class="line">mkdir -p user/document</span><br><span class="line">3.删除文件夹</span><br><span class="line">rm -rf document</span><br><span class="line">4.复制文件夹</span><br><span class="line">cp document new_name</span><br><span class="line"></span><br><span class="line">5.创建文件</span><br><span class="line">touch 1.txt</span><br><span class="line">6.删除文件</span><br><span class="line">rm 1.txt </span><br><span class="line"></span><br><span class="line">7.重命名或者移动</span><br><span class="line">mv aim new</span><br></pre></td></tr></table></figure>

<ul>
<li>环境变量</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">一，用户环境变量</span><br><span class="line">/user/ubuntu/.profile中添加shell脚本</span><br><span class="line"></span><br><span class="line">二，系统脚本</span><br><span class="line">在/etc/profile.d/目录下创建一个自定义脚本</span><br><span class="line"></span><br><span class="line">三，PATH环境变量</span><br><span class="line">echo $PATH 查看PATH环境变量</span><br><span class="line">在系统脚本下添加以下命令</span><br><span class="line">export PATH=$PATH:脚本路径</span><br></pre></td></tr></table></figure>

<ul>
<li>自动补全</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tab</span><br><span class="line">tab tab</span><br></pre></td></tr></table></figure>

<ul>
<li>vim</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">清空文件内容</span><br><span class="line">:%d</span><br></pre></td></tr></table></figure>

<ul>
<li>查看ip</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostname -I</span><br></pre></td></tr></table></figure>

<ul>
<li>模式切换</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.开机默认进入命令行</span><br><span class="line">sudo systemctl set-default multi-user.target </span><br><span class="line">2.开机默认进入桌面</span><br><span class="line">sudo systemctl set-default graphical.target </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>解压缩</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">归档文件</span><br><span class="line">tar -cvf name.tar file1 file2</span><br><span class="line"></span><br><span class="line">还原文件</span><br><span class="line">tar -xvf name.tar</span><br><span class="line">tar -xvf name.tar -C path</span><br><span class="line"></span><br><span class="line">压缩文件</span><br><span class="line">tar -zcvf name.tar.gz file1 file2</span><br><span class="line"></span><br><span class="line">解压文件</span><br><span class="line">tar -zxvf name.tar</span><br><span class="line">tar -zxvf name.tar -C path</span><br></pre></td></tr></table></figure>

<ul>
<li>创建软链接</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">创建软链接</span><br><span class="line">ln -s 操作对象 链接名字</span><br></pre></td></tr></table></figure>

<ul>
<li>用户操作</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">创建用户</span><br><span class="line">sudo useradd -m 用户名</span><br><span class="line"></span><br><span class="line">删除用户</span><br><span class="line">sudo userdel 用户名 </span><br><span class="line"></span><br><span class="line">修改用户密码</span><br><span class="line">sudo password 用户</span><br></pre></td></tr></table></figure>


<ul>
<li>修改文件权限</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">增加可执行权限</span><br><span class="line">chmod +x file</span><br><span class="line"></span><br><span class="line">增加可读权限</span><br><span class="line">chmod +r file</span><br><span class="line"></span><br><span class="line">增加可写权限</span><br><span class="line">chmod +w file</span><br></pre></td></tr></table></figure>


<ul>
<li>可执行脚本</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">shell脚本</span><br><span class="line">.sh文件，第一行声明shell解释器 #！/bin/sh</span><br><span class="line">添加可执行权限</span><br><span class="line">输入文件路径执行</span><br><span class="line"></span><br><span class="line">python脚本</span><br><span class="line">.python文件，第一行声明python解释器 #！/bin/python3</span><br><span class="line">添加可执行权限</span><br><span class="line">输入文件路径执行</span><br></pre></td></tr></table></figure>


<ul>
<li>ROS程序编译基础</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">自定义空间名space</span><br><span class="line">mkdir -p ws/src</span><br><span class="line"></span><br><span class="line">进入space执行编译</span><br><span class="line">catkin_make</span><br><span class="line"></span><br><span class="line">在src目录下创建包，添加依赖</span><br><span class="line">catkin_create_pkg car_project roscpp rospy std_msgs</span><br><span class="line"></span><br><span class="line">1，C++部分：</span><br><span class="line">在包的src目录下创建编写C++文件</span><br><span class="line"></span><br><span class="line">修改CMakeLists.txt文件</span><br><span class="line">修改行136、149</span><br><span class="line">add_executable(name</span><br><span class="line">  src/name.cpp</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">target_link_libraries(name</span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">&#123;catkin_LIBRARIES&#125;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">编译</span><br><span class="line">启动核心：roscore</span><br><span class="line">修改环境变量：source ./devel/setup.bash</span><br><span class="line">rosrun 包名 name</span><br><span class="line"></span><br><span class="line">2.python部分：</span><br><span class="line"></span><br><span class="line">在包下建立scripts文件存放python</span><br><span class="line"></span><br><span class="line">为python添加可执行条件：chmod +x name.py</span><br><span class="line">查看可执行权限：ll</span><br><span class="line"></span><br><span class="line">修改CMakeLists.txt文件</span><br><span class="line">修改行162：</span><br><span class="line">catkin_install_python(PROGRAMS </span><br><span class="line">scripts/自定义文件名.py</span><br><span class="line">  DESTINATION $&#123;CATKIN_PACKAGE_BIN_DESTINATION&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">编译</span><br><span class="line">启动核心：roscore</span><br><span class="line">修改环境变量：source ./devel/setup.bash</span><br><span class="line">rosrun 包名 name.py</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>wifi配置</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">network-config文件</span></span><br><span class="line">version: 2</span><br><span class="line">wifis:</span><br><span class="line">  renderer: networkd</span><br><span class="line">  wlan0:</span><br><span class="line">    dhcp4: true</span><br><span class="line">    optional: true</span><br><span class="line">    access-points:</span><br><span class="line">      &quot;lsksp&quot;:</span><br><span class="line">        password: &quot;12345678&quot;</span><br><span class="line">      &quot;lsk&quot;:</span><br><span class="line">        password: &quot;12345678&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">sudo</span> nano /etc/netplan/50-cloud-init.yaml</span></span><br><span class="line">network:</span><br><span class="line">    ethernets:</span><br><span class="line">        eth0:</span><br><span class="line">            dhcp4: true</span><br><span class="line">            optional: true</span><br><span class="line">    wifis:</span><br><span class="line">        wlan0:</span><br><span class="line">            optional: true</span><br><span class="line">            access-points:</span><br><span class="line">                &quot;WiFi名&quot;:</span><br><span class="line">                    password: &quot;你wifi的密码&quot;</span><br><span class="line">            dhcp4: true</span><br><span class="line">    version: 2</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">自定义</span></span><br><span class="line">network:</span><br><span class="line">    ethernets:</span><br><span class="line">        eth0:</span><br><span class="line">            dhcp4: true</span><br><span class="line">            optional: true</span><br><span class="line">    wifis:</span><br><span class="line">        wlan0:</span><br><span class="line">            optional: true</span><br><span class="line">            access-points:</span><br><span class="line">                lsk:</span><br><span class="line">                    password: &quot;12345678&quot;</span><br><span class="line"></span><br><span class="line">                lsksp:</span><br><span class="line">                    password: &quot;12345678&quot;</span><br><span class="line">            addresses: [192.168.167.8/24]</span><br><span class="line">            gateway4: 192.168.167.1</span><br><span class="line">            nameservers:</span><br><span class="line">                    addresses: [8.8.8.8, 144.144.144.144]</span><br><span class="line">            dhcp4: true</span><br><span class="line">    version: 2</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>查看进程并结束</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看</span></span><br><span class="line">ps aux | grep -i apt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">杀掉进程</span></span><br><span class="line">sudo kill &lt;process_id&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>apt软件管理工具</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">安装软件</span><br><span class="line">apt install 软件名</span><br><span class="line">卸载软件</span><br><span class="line">apt remove 软件名</span><br><span class="line">搜索</span><br><span class="line">apt search xxx</span><br><span class="line">列表</span><br><span class="line">apt list | grep xxx </span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-05-10T16:00:00.000Z" title="2025/5/11 00:00:00">2025-05-11</time>发表</span><span class="level-item"><time dateTime="2025-10-16T17:41:45.000Z" title="2025/10/17 01:41:45">2025-10-17</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/">工具使用</a></span><span class="level-item">1 分钟读完 (大约169个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Typora%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4/">Typora使用命令</a></p><div class="content"> <!-- toc -->

<h3 id="一、标题"><a href="#一、标题" class="headerlink" title="一、标题"></a>一、标题</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">一级标题</span><br><span class="line"># 名称</span><br><span class="line"></span><br><span class="line">六级标题</span><br><span class="line">###### 名称</span><br><span class="line"></span><br><span class="line">----------------------------------------------</span><br><span class="line">一级标题</span><br><span class="line">ctrl + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">六级标题</span><br><span class="line">ctrl + <span class="number">6</span></span><br><span class="line"></span><br><span class="line">清楚标题</span><br><span class="line">ctrl + <span class="number">0</span></span><br></pre></td></tr></table></figure>

<h3 id="二、有序列表"><a href="#二、有序列表" class="headerlink" title="二、有序列表"></a>二、有序列表</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 名称</span><br><span class="line">ctrl + shift +[</span><br><span class="line"></span><br><span class="line">降级</span><br><span class="line">tab</span><br><span class="line"></span><br><span class="line">升级</span><br><span class="line">shift + tab</span><br></pre></td></tr></table></figure>

<h3 id="三、无序列表"><a href="#三、无序列表" class="headerlink" title="三、无序列表"></a>三、无序列表</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 名称</span><br><span class="line">- 名称</span><br></pre></td></tr></table></figure>

<h3 id="四、任务列表"><a href="#四、任务列表" class="headerlink" title="四、任务列表"></a>四、任务列表</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- [ ] 名称</span><br></pre></td></tr></table></figure>

<h3 id="五、表格"><a href="#五、表格" class="headerlink" title="五、表格"></a>五、表格</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|名称|名称|名称|</span><br></pre></td></tr></table></figure>

<h3 id="六、代码"><a href="#六、代码" class="headerlink" title="六、代码"></a>六、代码</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">行内代码</span><br><span class="line">`内容`</span><br><span class="line"></span><br><span class="line">代码块</span><br><span class="line">```语言类型</span><br><span class="line">~~~语言类型</span><br><span class="line"></span><br><span class="line">-------------------------------------------------</span><br><span class="line"></span><br><span class="line">代码块</span><br><span class="line">ctrl + shift + k</span><br></pre></td></tr></table></figure>

<h3 id="七、图片"><a href="#七、图片" class="headerlink" title="七、图片"></a>七、图片</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">选择图片</span><br><span class="line">![]()</span><br></pre></td></tr></table></figure>

<h3 id="八、超链接"><a href="#八、超链接" class="headerlink" title="八、超链接"></a>八、超链接</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">超链接</span><br><span class="line">[显示](位置/链接)</span><br></pre></td></tr></table></figure>

<h3 id="九、水平分割线"><a href="#九、水平分割线" class="headerlink" title="九、水平分割线"></a>九、水平分割线</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">分割线</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<h3 id="十、引用"><a href="#十、引用" class="headerlink" title="十、引用"></a>十、引用</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">引用</span><br><span class="line">&gt; 内容</span><br></pre></td></tr></table></figure>

<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">加粗</span><br><span class="line">ctrl + b</span><br><span class="line"></span><br><span class="line">斜体</span><br><span class="line">ctrl + i</span><br><span class="line"></span><br><span class="line">高亮</span><br><span class="line">==内容==</span><br></pre></td></tr></table></figure>



</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-05-10T16:00:00.000Z" title="2025/5/11 00:00:00">2025-05-11</time>发表</span><span class="level-item"><time dateTime="2025-10-16T17:41:45.000Z" title="2025/10/17 01:41:45">2025-10-17</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/">工具使用</a></span><span class="level-item">21 分钟读完 (大约3147个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/">使用VScode开发STM32:基于CMake</a></p><div class="content"> <!-- toc -->

<h3 id="使用VScode开发STM32-基于CMake"><a href="#使用VScode开发STM32-基于CMake" class="headerlink" title="使用VScode开发STM32:基于CMake"></a>使用VScode开发STM32:基于CMake</h3><p>本教程使用VScode作为代码编辑工具、使用Cmake作为构建系统生成器、Make进行构建系统、使用arm-none-eabi-gcc进行交叉编译、使用OpenOCD作为代码下载与调试工具，最终搭建出适用于ARM架构系列芯片的开发环境。此教程以STM32F103ZET6芯片为例，演示LED灯闪烁的项目。</p>
<p>经验证，可满足基本基本项目需求。同时由于arm-none-eabi-gcc编译器相比于keil的AC5、AC6编译器，所编译的hex文件比较大，Flash占用较高，为了兼顾keil开发项目，也为了能够与其他人的项目兼容，这里的keil与VScode的项目文件互不干扰，满足兼容性需求。</p>
<p>本文涉及的软件安装包、工程模板已放在我的百度网盘中，需要自取。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">链接：https://pan.baidu.com/s/1pO-5R3Li5NIfctx3UzaPig?pwd=ts91 </span><br><span class="line">提取码：ts91 </span><br><span class="line">--来自百度网盘超级会员V4的分享</span><br></pre></td></tr></table></figure>

<h4 id="一、软件安装"><a href="#一、软件安装" class="headerlink" title="一、软件安装"></a>一、软件安装</h4><p>已默认电脑上存在VScode，这里不讲述Vscode的安装。</p>
<p>涉及软件的安装配置：</p>
<ul>
<li>安装Cmake</li>
<li>安装arm-none-eabi-gcc</li>
<li>安装OpenOCD</li>
<li>MinGW</li>
<li>安装VScode插件C&#x2F;C++、CMake、Cortex-Debug</li>
</ul>
<h5 id="1-1-安装CMake"><a href="#1-1-安装CMake" class="headerlink" title="1.1 安装CMake"></a>1.1 安装CMake</h5><h6 id="1-1-1-安装"><a href="#1-1-1-安装" class="headerlink" title="1.1.1 安装"></a>1.1.1 安装</h6><p>下载地址：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://cmake.org/download/</span><br></pre></td></tr></table></figure>

<p>选择适合自己电脑的最新版本进行下载并安装，我这里选择<code>cmake-3.29.2-windows-x86_64.msi</code>，如下图：</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/CMake.png" style="zoom:40%;">

<h6 id="1-1-2-添加环境变量"><a href="#1-1-2-添加环境变量" class="headerlink" title="1.1.2 添加环境变量"></a>1.1.2 添加环境变量</h6><p>我们需要将cmake的可执行文件的文件夹路径添加到环境变量，方便使用命令调用cmake，我的路径为：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D:\RJ\CMake\bin</span><br></pre></td></tr></table></figure>

<p>将以上目录添加到系统环境变量中去。</p>
<h6 id="1-1-3-验证"><a href="#1-1-3-验证" class="headerlink" title="1.1.3 验证"></a>1.1.3 验证</h6><p>在终端输入以下命令，验证是否安装成功。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake</span><br></pre></td></tr></table></figure>

<p>成功则将显示以下内容：</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/cmake_d.png" style="zoom:80%;">

<h5 id="1-2-安装arm-none-eabi-gcc"><a href="#1-2-安装arm-none-eabi-gcc" class="headerlink" title="1.2 安装arm-none-eabi-gcc"></a>1.2 安装arm-none-eabi-gcc</h5><h6 id="1-2-1-安装"><a href="#1-2-1-安装" class="headerlink" title="1.2.1 安装"></a>1.2.1 安装</h6><p>下载地址：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://developer.arm.com/downloads/-/gnu-rm</span><br></pre></td></tr></table></figure>

<p>选择适合自己电脑的最新版本进行下载并安装，我这里选择<code>gcc-arm-none-eabi-10.3-2021.10-win32.exe</code>，如下图：</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/armGCC.png" style="zoom:50%;">

<h6 id="1-2-2-添加环境变量"><a href="#1-2-2-添加环境变量" class="headerlink" title="1.2.2 添加环境变量"></a>1.2.2 添加环境变量</h6><p>我们需要将arm-gcc的可执行文件的文件夹路径添加到环境变量，方便使用命令调用arm-gcc，我的路径为:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D:\RJ\ARM-GCC\10 2021.10\bin</span><br></pre></td></tr></table></figure>

<p>将以上目录添加到系统环境变量中去。</p>
<h6 id="1-2-3-验证"><a href="#1-2-3-验证" class="headerlink" title="1.2.3 验证"></a>1.2.3 验证</h6><p>在终端输入以下命令，验证是否安装成功。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arm-none-eabi-gcc</span><br></pre></td></tr></table></figure>

<p>成功则将显示以下内容：</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/armGCC_D.png" style="zoom:50%;">

<h5 id="1-3-安装OpenOCD"><a href="#1-3-安装OpenOCD" class="headerlink" title="1.3 安装OpenOCD"></a>1.3 安装OpenOCD</h5><h6 id="1-3-1-安装"><a href="#1-3-1-安装" class="headerlink" title="1.3.1 安装"></a>1.3.1 安装</h6><p>下载地址：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://gnutoolchains.com/arm-eabi/openocd/</span><br></pre></td></tr></table></figure>

<p>选择适合自己电脑的最新版本进行下载，直接下载的是压缩包文件，解压后可直接使用，我这里选择<code>openocd-20231002.7z</code>，如下图：</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/openOCD.png" style="zoom:50%;">

<h6 id="1-3-2-添加环境变量"><a href="#1-3-2-添加环境变量" class="headerlink" title="1.3.2 添加环境变量"></a>1.3.2 添加环境变量</h6><p>我们需要将OpenOCD的可执行文件的文件夹路径添加到环境变量，方便使用命令调用OpenOCD，我的路径为:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D:\RJ\OpenOCD-20231002-0.12.0\bin</span><br></pre></td></tr></table></figure>

<p>将以上目录添加到系统环境变量中去。</p>
<h6 id="1-3-3-验证"><a href="#1-3-3-验证" class="headerlink" title="1.3.3 验证"></a>1.3.3 验证</h6><p>在终端输入以下命令，验证是否安装成功。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openOCD</span><br></pre></td></tr></table></figure>

<p>成功则将显示以下内容：</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/openocd_D.png" style="zoom:50%;">

<h5 id="1-4-安装MinGW"><a href="#1-4-安装MinGW" class="headerlink" title="1.4 安装MinGW"></a>1.4 安装MinGW</h5><h6 id="1-4-1-安装"><a href="#1-4-1-安装" class="headerlink" title="1.4.1 安装"></a>1.4.1 安装</h6><p>下载地址：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://sourceforge.net/projects/mingw-w64/files/</span><br></pre></td></tr></table></figure>

<p>选择适合自己电脑的最新版本进行下载，直接下载的是压缩包文件，解压后的mingw64可直接使用，我这里选择MinGW-W64GCC-8.1.0下的<code>x86_64-posix-sjlj</code>，如下图：</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/MiniGW.png" style="zoom:80%;">

<h6 id="1-4-2-添加环境变量"><a href="#1-4-2-添加环境变量" class="headerlink" title="1.4.2 添加环境变量"></a>1.4.2 添加环境变量</h6><p>我们需要将make的可执行文件的文件夹路径添加到环境变量，方便使用命令调用make，我的路径为:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D:\RJ\mingw64\bin</span><br></pre></td></tr></table></figure>

<p>将以上目录添加到系统环境变量中去。</p>
<h6 id="1-3-3-验证-1"><a href="#1-3-3-验证-1" class="headerlink" title="1.3.3 验证"></a>1.3.3 验证</h6><p>在终端输入以下命令，验证是否安装成功(由于Window下make执行程序为mingw32-make.exe，我这里将其复制保存同目录下为副本，并改名为make.exe)。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make</span><br></pre></td></tr></table></figure>

<p>成功则将显示以下内容：</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/make_D.png" style="zoom:50%;">

<h5 id="1-5-在Vscode中安装插件"><a href="#1-5-在Vscode中安装插件" class="headerlink" title="1.5 在Vscode中安装插件"></a>1.5 在Vscode中安装插件</h5><p>要安装的插件如下：</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/vscode.png" style="zoom:80%;">

<h4 id="二、工程搭建"><a href="#二、工程搭建" class="headerlink" title="二、工程搭建"></a>二、工程搭建</h4><p>以下是我的工程框架</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/Snipaste_2024-04-27_21-53-50.png" style="zoom: 50%;">

<p>与ARM-MDK工程不同，我们配置工程还需要格外的文件，分别是CMakeLists.txt、startup_stm32f10x_hd.s、STM32F103ZETx_FLASH.ld。</p>
<h5 id="2-1-配置CMakeLists-txt文件"><a href="#2-1-配置CMakeLists-txt文件" class="headerlink" title="2.1 配置CMakeLists.txt文件"></a>2.1 配置CMakeLists.txt文件</h5><p>CMake根据CMakeLists.txt进行构建，从而创建出Makefile，再由make根据 Makefile 定义的规则调用 GCC 执行编译工作，最终生成可执行的.elf或者.hex文件。以下是CMakeLists.txt的模板，需要更改的部分我已经标明。</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#THIS FILE IS AUTO GENERATED FROM THE TEMPLATE! DO NOT CHANGE!</span></span><br><span class="line">set(CMAKE_SYSTEM_NAME Generic)</span><br><span class="line">set(CMAKE_SYSTEM_VERSION 1)</span><br><span class="line">cmake_minimum_required(VERSION 3.20)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># specify cross compilers and tools</span></span><br><span class="line">set(CMAKE_C_COMPILER arm-none-eabi-gcc)</span><br><span class="line">set(CMAKE_CXX_COMPILER arm-none-eabi-g++)</span><br><span class="line">set(CMAKE_ASM_COMPILER arm-none-eabi-gcc)</span><br><span class="line">set(CMAKE_AR arm-none-eabi-ar)</span><br><span class="line">set(CMAKE_OBJCOPY arm-none-eabi-objcopy)</span><br><span class="line">set(CMAKE_OBJDUMP arm-none-eabi-objdump)</span><br><span class="line">set(SIZE arm-none-eabi-size)</span><br><span class="line">set(CMAKE_TRY_COMPILE_TARGET_TYPE STATIC_LIBRARY)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># project settings</span></span><br><span class="line">project(Project  C CXX ASM)</span><br><span class="line">set(CMAKE_CXX_STANDARD 17)</span><br><span class="line">set(CMAKE_C_STANDARD 11)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#Uncomment for hardware floating point</span></span><br><span class="line"><span class="comment">#add_compile_definitions(ARM_MATH_CM4;ARM_MATH_MATRIX_CHECK;ARM_MATH_ROUNDING)</span></span><br><span class="line"><span class="comment">#add_compile_options(-mfloat-abi=hard -mfpu=fpv4-sp-d16)</span></span><br><span class="line"><span class="comment">#add_link_options(-mfloat-abi=hard -mfpu=fpv4-sp-d16)</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#Uncomment for software floating point</span></span><br><span class="line"><span class="comment">#add_compile_options(-mfloat-abi=soft)</span></span><br><span class="line"> </span><br><span class="line">add_compile_options(-mcpu=cortex-m3 -mthumb -mthumb-interwork)</span><br><span class="line">add_compile_options(-ffunction-sections -fdata-sections -fno-common -fmessage-length=0)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># uncomment to mitigate c++17 absolute addresses warnings</span></span><br><span class="line"><span class="comment">#set(CMAKE_CXX_FLAGS &quot;$&#123;CMAKE_CXX_FLAGS&#125; -Wno-register&quot;)</span></span><br><span class="line">if (<span class="string">&quot;$&#123;CMAKE_BUILD_TYPE&#125;&quot;</span> STREQUAL <span class="string">&quot;Release&quot;</span>)</span><br><span class="line">    message(VERBOSE <span class="string">&quot;Maximum optimization for speed&quot;</span>)</span><br><span class="line">    add_compile_options(-Ofast)</span><br><span class="line">elseif (<span class="string">&quot;$&#123;CMAKE_BUILD_TYPE&#125;&quot;</span> STREQUAL <span class="string">&quot;RelWithDebInfo&quot;</span>)</span><br><span class="line">    message(VERBOSE <span class="string">&quot;Maximum optimization for speed, debug info included&quot;</span>)</span><br><span class="line">    add_compile_options(-Ofast -g)</span><br><span class="line">elseif (<span class="string">&quot;$&#123;CMAKE_BUILD_TYPE&#125;&quot;</span> STREQUAL <span class="string">&quot;MinSizeRel&quot;</span>)</span><br><span class="line">    message(VERBOSE <span class="string">&quot;Maximum optimization for size&quot;</span>)</span><br><span class="line">    add_compile_options(-Os)</span><br><span class="line"><span class="keyword">else</span> ()</span><br><span class="line">    message(VERBOSE <span class="string">&quot;Minimal optimization, debug info included&quot;</span>)</span><br><span class="line">    add_compile_options(-Og -g)</span><br><span class="line"><span class="keyword">endif</span> ()</span><br><span class="line"></span><br><span class="line"><span class="comment">#添加宏定义</span></span><br><span class="line">add_definitions(-DUSE_HAL_DRIVER -DSTM32F103xB -DUSE_STDPERIPH_DRIVER -DSTM32F10X_HD)</span><br><span class="line"></span><br><span class="line"><span class="comment">#添加头文件路径，即.h文件</span></span><br><span class="line">include_directories(./STM32F10x_FWLib/inc ./User ./Project/Code-Cmake)</span><br><span class="line"><span class="comment">#添加源文件路径,即.c或者.s文件</span></span><br><span class="line">file(GLOB_RECURSE SOURCES ./STM32F10x_FWLib/src/*.c ./User/*.c ./Project/Code-Cmake/*.*)</span><br><span class="line"></span><br><span class="line"><span class="comment">#添加你的STM32F103ZETx_FLASH.ld的连接脚本路径</span></span><br><span class="line">set(LINKER_SCRIPT $&#123;CMAKE_SOURCE_DIR&#125;/Project/Code-Cmake/STM32F103ZETx_FLASH.ld)</span><br><span class="line"> </span><br><span class="line">add_link_options(-Wl,-gc-sections,--print-memory-usage,-Map=$&#123;PROJECT_BINARY_DIR&#125;/$&#123;PROJECT_NAME&#125;.map)</span><br><span class="line"><span class="comment">#选择cortex-m3内核</span></span><br><span class="line">add_link_options(-mcpu=cortex-m3 -mthumb -mthumb-interwork)</span><br><span class="line">add_link_options(-T $&#123;LINKER_SCRIPT&#125;)</span><br><span class="line"> </span><br><span class="line">add_link_options(-specs=nano.specs -specs=nosys.specs -u _printf_float)</span><br><span class="line"> </span><br><span class="line">add_executable($&#123;PROJECT_NAME&#125;.elf $&#123;SOURCES&#125; $&#123;LINKER_SCRIPT&#125;)</span><br><span class="line"> </span><br><span class="line">set(HEX_FILE $&#123;PROJECT_BINARY_DIR&#125;/$&#123;PROJECT_NAME&#125;.hex)</span><br><span class="line">set(BIN_FILE $&#123;PROJECT_BINARY_DIR&#125;/$&#123;PROJECT_NAME&#125;.bin)</span><br><span class="line"> </span><br><span class="line">add_custom_command(TARGET $&#123;PROJECT_NAME&#125;.elf POST_BUILD</span><br><span class="line">        COMMAND $&#123;CMAKE_OBJCOPY&#125; -Oihex <span class="variable">$&lt;</span>TARGET_FILE:$&#123;PROJECT_NAME&#125;.elf&gt; $&#123;HEX_FILE&#125;</span><br><span class="line">        COMMAND $&#123;CMAKE_OBJCOPY&#125; -Obinary <span class="variable">$&lt;</span>TARGET_FILE:$&#123;PROJECT_NAME&#125;.elf&gt; $&#123;BIN_FILE&#125;</span><br><span class="line">        COMMENT <span class="string">&quot;Building $&#123;HEX_FILE&#125;</span></span><br><span class="line"><span class="string">Building $&#123;BIN_FILE&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

<h5 id="2-2-选择startup-stm32f10x-hd-s"><a href="#2-2-选择startup-stm32f10x-hd-s" class="headerlink" title="2.2 选择startup_stm32f10x_hd.s"></a>2.2 选择startup_stm32f10x_hd.s</h5><p>在我们创建ARM-MDK工程时，我们从官方的固件包中选择的是arm版本的启动文件，在这里我们要选择gcc版本的启动文件，即下图中的gcc_ride7。同时为了与ARM-MDK有所区分，我将该文件放在了&#x2F;Project&#x2F;Code-Cmake文件夹下。</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/start.png" style="zoom:80%;">

<h5 id="2-3-STM32F103ZETx-FLASH-ld"><a href="#2-3-STM32F103ZETx-FLASH-ld" class="headerlink" title="2.3 STM32F103ZETx_FLASH.ld"></a>2.3 STM32F103ZETx_FLASH.ld</h5><p>STM32F103ZETx_FLASH.ld是一个链接脚本文件，它告诉编译器相关的编译后的可执行代码，内存变量，中断向量，链接在哪个存储区。获取方式主要有三种（请根据自己单片机型号选择）：</p>
<ul>
<li>使用CudeMax编译过程可以生成该链接脚本</li>
<li>搜索已有的工程，你可以直接在浏览器搜索STM32F103ZETx_FLASH.ld，一般都有。</li>
<li>如果你对该型号芯片足够了解，可以自行编写。</li>
</ul>
<p>以下是我的STM32F103ZETx_FLASH.ld:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">******************************************************************************</span><br><span class="line">**</span><br><span class="line">** @file        : LinkerScript.ld</span><br><span class="line">**</span><br><span class="line">** @author      : Auto-generated by STM32CubeIDE</span><br><span class="line">**</span><br><span class="line">** @brief       : Linker script for STM32F103ZETx Device from STM32F1 series</span><br><span class="line">**                      512Kbytes FLASH</span><br><span class="line">**                      64Kbytes RAM</span><br><span class="line">**</span><br><span class="line">**                Set heap size, stack size and stack location according</span><br><span class="line">**                to application requirements.</span><br><span class="line">**</span><br><span class="line">**                Set memory bank area and size if external memory is used</span><br><span class="line">**</span><br><span class="line">**  Target      : STMicroelectronics STM32</span><br><span class="line">**</span><br><span class="line">**  Distribution: The file is distributed as is, without any warranty</span><br><span class="line">**                of any kind.</span><br><span class="line">**</span><br><span class="line">******************************************************************************</span><br><span class="line">** @attention</span><br><span class="line">**</span><br><span class="line">** &lt;h2&gt;&lt;center&gt;&amp;copy; Copyright (c) 2021 STMicroelectronics.</span><br><span class="line">** All rights reserved.&lt;/center&gt;&lt;/h2&gt;</span><br><span class="line">**</span><br><span class="line">** This software component is licensed by ST under BSD 3-Clause license,</span><br><span class="line">** the &quot;License&quot;; You may not use this file except in compliance with the</span><br><span class="line">** License. You may obtain a copy of the License at:</span><br><span class="line">**                        opensource.org/licenses/BSD-3-Clause</span><br><span class="line">**</span><br><span class="line">******************************************************************************</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">/* Entry Point */</span><br><span class="line">ENTRY(Reset_Handler)</span><br><span class="line"></span><br><span class="line">/* Highest address of the user mode stack */</span><br><span class="line">_estack = ORIGIN(RAM) + LENGTH(RAM); /* end of &quot;RAM&quot; Ram type memory */</span><br><span class="line"></span><br><span class="line">_Min_Heap_Size = 0x200 ; /* required amount of heap */</span><br><span class="line">_Min_Stack_Size = 0x400 ; /* required amount of stack */</span><br><span class="line"></span><br><span class="line">/* Memories definition */</span><br><span class="line">MEMORY</span><br><span class="line">&#123;</span><br><span class="line">  RAM    (xrw)    : ORIGIN = 0x20000000,   LENGTH = 64K</span><br><span class="line">  FLASH    (rx)    : ORIGIN = 0x8000000,   LENGTH = 512K</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* Sections */</span><br><span class="line">SECTIONS</span><br><span class="line">&#123;</span><br><span class="line">  /* The startup code into &quot;FLASH&quot; Rom type memory */</span><br><span class="line">  .isr_vector :</span><br><span class="line">  &#123;</span><br><span class="line">    . = ALIGN(4);</span><br><span class="line">    KEEP(*(.isr_vector)) /* Startup code */</span><br><span class="line">    . = ALIGN(4);</span><br><span class="line">  &#125; &gt;FLASH</span><br><span class="line"></span><br><span class="line">  /* The program code and other data into &quot;FLASH&quot; Rom type memory */</span><br><span class="line">  .text :</span><br><span class="line">  &#123;</span><br><span class="line">    . = ALIGN(4);</span><br><span class="line">    *(.text)           /* .text sections (code) */</span><br><span class="line">    *(.text*)          /* .text* sections (code) */</span><br><span class="line">    *(.glue_7)         /* glue arm to thumb code */</span><br><span class="line">    *(.glue_7t)        /* glue thumb to arm code */</span><br><span class="line">    *(.eh_frame)</span><br><span class="line"></span><br><span class="line">    KEEP (*(.init))</span><br><span class="line">    KEEP (*(.fini))</span><br><span class="line"></span><br><span class="line">    . = ALIGN(4);</span><br><span class="line">    _etext = .;        /* define a global symbols at end of code */</span><br><span class="line">  &#125; &gt;FLASH</span><br><span class="line"></span><br><span class="line">  /* Constant data into &quot;FLASH&quot; Rom type memory */</span><br><span class="line">  .rodata :</span><br><span class="line">  &#123;</span><br><span class="line">    . = ALIGN(4);</span><br><span class="line">    *(.rodata)         /* .rodata sections (constants, strings, etc.) */</span><br><span class="line">    *(.rodata*)        /* .rodata* sections (constants, strings, etc.) */</span><br><span class="line">    . = ALIGN(4);</span><br><span class="line">  &#125; &gt;FLASH</span><br><span class="line"></span><br><span class="line">  .ARM.extab   : &#123;</span><br><span class="line">    . = ALIGN(4);</span><br><span class="line">    *(.ARM.extab* .gnu.linkonce.armextab.*)</span><br><span class="line">    . = ALIGN(4);</span><br><span class="line">  &#125; &gt;FLASH</span><br><span class="line"></span><br><span class="line">  .ARM : &#123;</span><br><span class="line">    . = ALIGN(4);</span><br><span class="line">    __exidx_start = .;</span><br><span class="line">    *(.ARM.exidx*)</span><br><span class="line">    __exidx_end = .;</span><br><span class="line">    . = ALIGN(4);</span><br><span class="line">  &#125; &gt;FLASH</span><br><span class="line"></span><br><span class="line">  .preinit_array     :</span><br><span class="line">  &#123;</span><br><span class="line">    . = ALIGN(4);</span><br><span class="line">    PROVIDE_HIDDEN (__preinit_array_start = .);</span><br><span class="line">    KEEP (*(.preinit_array*))</span><br><span class="line">    PROVIDE_HIDDEN (__preinit_array_end = .);</span><br><span class="line">    . = ALIGN(4);</span><br><span class="line">  &#125; &gt;FLASH</span><br><span class="line"></span><br><span class="line">  .init_array :</span><br><span class="line">  &#123;</span><br><span class="line">    . = ALIGN(4);</span><br><span class="line">    PROVIDE_HIDDEN (__init_array_start = .);</span><br><span class="line">    KEEP (*(SORT(.init_array.*)))</span><br><span class="line">    KEEP (*(.init_array*))</span><br><span class="line">    PROVIDE_HIDDEN (__init_array_end = .);</span><br><span class="line">    . = ALIGN(4);</span><br><span class="line">  &#125; &gt;FLASH</span><br><span class="line"></span><br><span class="line">  .fini_array :</span><br><span class="line">  &#123;</span><br><span class="line">    . = ALIGN(4);</span><br><span class="line">    PROVIDE_HIDDEN (__fini_array_start = .);</span><br><span class="line">    KEEP (*(SORT(.fini_array.*)))</span><br><span class="line">    KEEP (*(.fini_array*))</span><br><span class="line">    PROVIDE_HIDDEN (__fini_array_end = .);</span><br><span class="line">    . = ALIGN(4);</span><br><span class="line">  &#125; &gt;FLASH</span><br><span class="line"></span><br><span class="line">  /* Used by the startup to initialize data */</span><br><span class="line">  _sidata = LOADADDR(.data);</span><br><span class="line"></span><br><span class="line">  /* Initialized data sections into &quot;RAM&quot; Ram type memory */</span><br><span class="line">  .data :</span><br><span class="line">  &#123;</span><br><span class="line">    . = ALIGN(4);</span><br><span class="line">    _sdata = .;        /* create a global symbol at data start */</span><br><span class="line">    *(.data)           /* .data sections */</span><br><span class="line">    *(.data*)          /* .data* sections */</span><br><span class="line">    *(.RamFunc)        /* .RamFunc sections */</span><br><span class="line">    *(.RamFunc*)       /* .RamFunc* sections */</span><br><span class="line"></span><br><span class="line">    . = ALIGN(4);</span><br><span class="line">    _edata = .;        /* define a global symbol at data end */</span><br><span class="line"></span><br><span class="line">  &#125; &gt;RAM AT&gt; FLASH</span><br><span class="line"></span><br><span class="line">  /* Uninitialized data section into &quot;RAM&quot; Ram type memory */</span><br><span class="line">  . = ALIGN(4);</span><br><span class="line">  .bss :</span><br><span class="line">  &#123;</span><br><span class="line">    /* This is used by the startup in order to initialize the .bss section */</span><br><span class="line">    _sbss = .;         /* define a global symbol at bss start */</span><br><span class="line">    __bss_start__ = _sbss;</span><br><span class="line">    *(.bss)</span><br><span class="line">    *(.bss*)</span><br><span class="line">    *(COMMON)</span><br><span class="line"></span><br><span class="line">    . = ALIGN(4);</span><br><span class="line">    _ebss = .;         /* define a global symbol at bss end */</span><br><span class="line">    __bss_end__ = _ebss;</span><br><span class="line">  &#125; &gt;RAM</span><br><span class="line"></span><br><span class="line">  /* User_heap_stack section, used to check that there is enough &quot;RAM&quot; Ram  type memory left */</span><br><span class="line">  ._user_heap_stack :</span><br><span class="line">  &#123;</span><br><span class="line">    . = ALIGN(8);</span><br><span class="line">    PROVIDE ( end = . );</span><br><span class="line">    PROVIDE ( _end = . );</span><br><span class="line">    . = . + _Min_Heap_Size;</span><br><span class="line">    . = . + _Min_Stack_Size;</span><br><span class="line">    . = ALIGN(8);</span><br><span class="line">  &#125; &gt;RAM</span><br><span class="line"></span><br><span class="line">  /* Remove information from the compiler libraries */</span><br><span class="line">  /DISCARD/ :</span><br><span class="line">  &#123;</span><br><span class="line">    libc.a ( * )</span><br><span class="line">    libm.a ( * )</span><br><span class="line">    libgcc.a ( * )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .ARM.attributes 0 : &#123; *(.ARM.attributes) &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="2-4-关于core-cm3-c文件"><a href="#2-4-关于core-cm3-c文件" class="headerlink" title="2.4 关于core_cm3.c文件"></a>2.4 关于core_cm3.c文件</h5><p>由于gcc编译的问题，如果不更改core_cm3.c，可能出现以下报错：</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/err.png" style="zoom:80%;">

<p>我对此做出以下两处更改，并放在了&#x2F;Project&#x2F;Code-Cmake文件夹下，与MDK-ARM分开：</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/err1.png" style="zoom:80%;">

<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/err2.png">

<h5 id="2-5-配置-vscode文件夹"><a href="#2-5-配置-vscode文件夹" class="headerlink" title="2.5 配置.vscode文件夹"></a>2.5 配置.vscode文件夹</h5><p>这是VScode配置文件的位置</p>
<h6 id="2-4-1-添加并配置c-cpp-properties-json"><a href="#2-4-1-添加并配置c-cpp-properties-json" class="headerlink" title="2.4.1 添加并配置c_cpp_properties.json"></a>2.4.1 添加并配置c_cpp_properties.json</h6><p>将其C&#x2F;C++模式更改为gcc-arm，注意将gcc路径替换为自己的路径</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;configurations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Win32&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;includePath&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;$&#123;workspaceFolder&#125;/**&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;defines&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;_DEBUG&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;UNICODE&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;_UNICODE&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;compilerPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;D:\\RJ\\mingw64\\bin\\gcc.exe&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cStandard&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gnu17&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cppStandard&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gnu++14&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;intelliSenseMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gcc-arm&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;configurationProvider&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ms-vscode.cmake-tools&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="number">4</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>2.4.1 添加并配置launch.json</p>
<p>这个文件是关于烧录与调试相关的，在此目录下你可以选择你的下载器型号、芯片型号。其中的stm32f103.svd可以在调试时查看看寄存器的值，请将以下路径改为自己工程的路径。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// 使用 IntelliSense 了解相关属性。 </span></span><br><span class="line">    <span class="comment">// 悬停以查看现有属性的描述。</span></span><br><span class="line">    <span class="comment">// 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid=830387</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.2.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;configurations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;workspaceRoot&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;executable&quot;</span><span class="punctuation">:</span> <span class="string">&quot;D:/GC/STM32F1/build/Project.elf&quot;</span><span class="punctuation">,</span>   </span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Debug with OpenOCD&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;request&quot;</span><span class="punctuation">:</span> <span class="string">&quot;launch&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cortex-debug&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;servertype&quot;</span><span class="punctuation">:</span> <span class="string">&quot;openocd&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;configFiles&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;D:/RJ/OpenOCD-20231002-0.12.0/share/openocd/scripts/interface/stlink-v2.cfg&quot;</span><span class="punctuation">,</span>  <span class="comment">//在OpenOCD选择下载器</span></span><br><span class="line">                <span class="string">&quot;D:/RJ/OpenOCD-20231002-0.12.0/share/openocd/scripts/target/stm32f1x.cfg&quot;</span>    <span class="comment">//在OpenOCD选择芯片</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;svdFile&quot;</span><span class="punctuation">:</span> <span class="string">&quot;D:/GC/STM32F1/stm32f103.svd&quot;</span><span class="punctuation">,</span>   <span class="comment">//选择寄存器文件</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="三、编译、下载与调试"><a href="#三、编译、下载与调试" class="headerlink" title="三、编译、下载与调试"></a>三、编译、下载与调试</h4><p>如果我们配置完成后，用VScode打开CMakeLists.txt所在文件夹工程过后，Cmake tool会自动提示配置Cmake，点击配置后，会生成build文件夹，产生的Makefile及其他中间文件会存放在该目录。</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/1-17142658887931.png">

<h5 id="3-1-选择编译器"><a href="#3-1-选择编译器" class="headerlink" title="3.1 选择编译器"></a>3.1 选择编译器</h5><p>点击VScode下方的配置按钮，选择gcc-arm</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/2.png">

<h5 id="3-2-编译"><a href="#3-2-编译" class="headerlink" title="3.2 编译"></a>3.2 编译</h5><p>点击VScode下方的进行编译，生成目标文件</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/3.png">

<p>编译过程</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/编译过程.png">

<p>在build文件夹下会生成目标文件</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/目标文件.png">

<h5 id="3-3-烧录"><a href="#3-3-烧录" class="headerlink" title="3.3 烧录"></a>3.3 烧录</h5><p>进入build文件夹下执行以下命令,其中将Project.hex替换为自己的目标文件，stlink-v2.cfg是选择下载器类型，stm32f1x.cfg是芯片型号</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openocd -f interface/stlink-v2.cfg -f target/stm32f1x.cfg -c &quot;program Project.hex verify reset exit&quot;</span><br></pre></td></tr></table></figure>

<p>烧录成功</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/烧录.png">

<h5 id="3-3-调试"><a href="#3-3-调试" class="headerlink" title="3.3 调试"></a>3.3 调试</h5><p>打开左侧的运行和调试，选择Debug with OpenOCD</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/调试.png">

<p>点击运行，可进行断点调试，变量监测，寄存器查看等操作。</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/finish.png">

<h5 id="3-4-关于变量定义"><a href="#3-4-关于变量定义" class="headerlink" title="3.4 关于变量定义"></a>3.4 关于变量定义</h5><p>使用gcc编译时，我们一般需要告诉编译器这个变量是可变的，不然会造成内存覆盖，程序无法运行的情况，即<code>voatile</code>关键词</p>
<img src="/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E4%BD%BF%E7%94%A8VScode%E5%BC%80%E5%8F%91STM32%E5%9F%BA%E4%BA%8ECMake/volite.png">

<p>四、参考链接</p>
<p>此文章参考以下文章，若描述不清，可查看下方文章</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yyz_1987/article/details/131000116">Vscode搭建开发调试STM32&#x2F;RISC-V环境IDE(最全面)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/jf_52001760/article/details/126826393">VSCode 和 CMake 搭建嵌入式开发环境</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-05-06T16:00:00.000Z" title="2025/5/7 00:00:00">2025-05-07</time>发表</span><span class="level-item"><time dateTime="2025-10-16T17:41:45.000Z" title="2025/10/17 01:41:45">2025-10-17</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E5%86%8D%E6%8E%A2C%E8%AF%AD%E8%A8%80/">再探C语言</a></span><span class="level-item">24 分钟读完 (大约3617个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/%E5%86%8D%E6%8E%A2C%E8%AF%AD%E8%A8%80/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/">数据结构与算法</a></p><div class="content"> <!-- toc -->

<h3 id="一、数据结构与算法：线性表"><a href="#一、数据结构与算法：线性表" class="headerlink" title="一、数据结构与算法：线性表"></a>一、数据结构与算法：线性表</h3><h4 id="1、顺序表"><a href="#1、顺序表" class="headerlink" title="1、顺序表"></a>1、顺序表</h4><p>实现代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> E;  <span class="comment">//定义顺序表存储的数据为int</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">List</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    E *<span class="built_in">array</span>;    <span class="comment">//实现顺序表的底层数组</span></span><br><span class="line">    <span class="type">int</span> capacity;   <span class="comment">//表示底层数组的容量</span></span><br><span class="line">    <span class="type">int</span> size;   <span class="comment">//已存多少数据</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//插入元素</span></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">insertList</span><span class="params">(<span class="keyword">struct</span> List *<span class="built_in">list</span>, E element, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (index &lt; <span class="number">1</span> || index &gt; <span class="built_in">list</span>-&gt;size + <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;  <span class="comment">//index可能非法</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">list</span>-&gt;size == <span class="built_in">list</span>-&gt;capacity)&#123;   <span class="comment">//判断顺序表是否满了，若满，则扩容。</span></span><br><span class="line">        <span class="type">int</span> newCapacity = <span class="built_in">list</span>-&gt;capacity + (<span class="built_in">list</span>-&gt;capacity &gt;&gt; <span class="number">1</span>);   <span class="comment">//&gt;&gt;1 相当于/2</span></span><br><span class="line">        E * newList = <span class="built_in">realloc</span>(<span class="built_in">list</span>-&gt;<span class="built_in">array</span>, newCapacity*<span class="keyword">sizeof</span>(E));</span><br><span class="line">        <span class="keyword">if</span>(newList == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">list</span>-&gt;<span class="built_in">array</span> = newList;</span><br><span class="line">        <span class="built_in">list</span>-&gt;capacity = newCapacity;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="built_in">list</span>-&gt;size; i&gt;=index; --i)&#123;</span><br><span class="line">        <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i] = <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[index - <span class="number">1</span>] = element;</span><br><span class="line">    <span class="built_in">list</span>-&gt;size++;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除元素</span></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">deleteList</span><span class="params">(<span class="keyword">struct</span> List *<span class="built_in">list</span>,<span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(index &lt; <span class="number">1</span> || index &gt; <span class="built_in">list</span>-&gt;size) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = index - <span class="number">1</span>; i &lt; <span class="built_in">list</span>-&gt;size - <span class="number">1</span>; ++i)&#123;</span><br><span class="line">        <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i] = <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i+<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">list</span>-&gt;size--;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//活得顺序表大小</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">sizeList</span><span class="params">(<span class="keyword">struct</span> List *<span class="built_in">list</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>-&gt;size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获得元素</span></span><br><span class="line">E * <span class="title function_">getList</span><span class="params">(<span class="keyword">struct</span> List *<span class="built_in">list</span>, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(index &lt; <span class="number">1</span> || index &gt; <span class="built_in">list</span>-&gt;size) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> &amp;<span class="built_in">list</span>-&gt;<span class="built_in">array</span>[index<span class="number">-1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//查找元素</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">findList</span><span class="params">(<span class="keyword">struct</span> List *<span class="built_in">list</span>,E element)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">list</span>-&gt;size; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i] == element) <span class="keyword">return</span> i + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">**</span></span><br><span class="line"><span class="comment">**</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">initList</span><span class="params">(<span class="keyword">struct</span> List *<span class="built_in">list</span> )</span>&#123;</span><br><span class="line">    <span class="built_in">list</span>-&gt;<span class="built_in">array</span> = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(E)*<span class="number">10</span>); <span class="comment">//malloc开辟的内存在堆区，函数生命周期结束后还存在（需要手动释放或程序结束后由系统释放）。</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">list</span>-&gt;<span class="built_in">array</span> == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;  <span class="comment">//若申请内存空间失败，则返回0.</span></span><br><span class="line">    <span class="built_in">list</span>-&gt;capacity = <span class="number">10</span>;</span><br><span class="line">    <span class="built_in">list</span>-&gt;size = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">printList</span><span class="params">(<span class="keyword">struct</span> List *<span class="built_in">list</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i&lt;<span class="built_in">list</span>-&gt;size; ++i)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">int</span>* argv)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">List</span> * <span class="title">list</span> =</span> <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> List *));</span><br><span class="line">    <span class="comment">/*结构体指针初始化，首先不能 “= NULL”，因为指针指向一个安全的区域，不能解析。</span></span><br><span class="line"><span class="comment">    **也不能，不初始化，因为指针可能指向未知地址，对其操作造成的后果是未知的，</span></span><br><span class="line"><span class="comment">    **初始化方式有：一、在堆区开辟一个空间；二、先定义一个结构体，用指针指向他；</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">if</span>(initList(<span class="built_in">list</span>))&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i&lt;<span class="number">10</span>; ++i)&#123;</span><br><span class="line">            insertList(<span class="built_in">list</span>,i*<span class="number">10</span>,i+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        deleteList(<span class="built_in">list</span>,<span class="number">2</span>);</span><br><span class="line">        printList(<span class="built_in">list</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d \n&quot;</span>,*getList(<span class="built_in">list</span>,<span class="number">2</span>));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,findList(<span class="built_in">list</span>,<span class="number">30</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;shibai&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(<span class="built_in">list</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>顺序表是一种随机存取的存储结构。</p>
<h4 id="2、链表"><a href="#2、链表" class="headerlink" title="2、链表"></a>2、链表</h4><p>实现代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> E;  <span class="comment">//定义顺序表存储的数据为int</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span>&#123;</span></span><br><span class="line">    E element;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span>* <span class="title">Node</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">initList</span><span class="params">(Node node)</span>&#123;</span><br><span class="line">    node-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">insertList</span><span class="params">(Node head, E element, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(index &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(--index)&#123;</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">        <span class="keyword">if</span>(head == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Node node = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> ListNode));</span><br><span class="line">    <span class="keyword">if</span>(node == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    node-&gt;element = element;</span><br><span class="line">    node-&gt;next = head-&gt;next;</span><br><span class="line">    head-&gt;next = node;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">deleteList</span><span class="params">(Node head, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(index &lt; <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(--index)&#123;</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">        <span class="keyword">if</span>(head == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(head-&gt;next == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    Node node = head-&gt;next; </span><br><span class="line">    head-&gt;next = head-&gt;next-&gt;next;</span><br><span class="line">    <span class="built_in">free</span>(node);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获得元素；</span></span><br><span class="line">E *<span class="title function_">getList</span><span class="params">(Node head, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(index &lt; <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (head-&gt;next == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="literal">NULL</span>;    <span class="comment">//若为空表，则返回为空；</span></span><br><span class="line">    <span class="keyword">do</span>&#123;</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">        <span class="keyword">if</span>(head == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;<span class="keyword">while</span>(--index);</span><br><span class="line">    <span class="keyword">return</span> &amp;head-&gt;element;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//寻找元素下标</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">findList</span><span class="params">(Node head, E element)</span>&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(head-&gt;next == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">-1</span>;   <span class="comment">//判断是否为空表</span></span><br><span class="line">    <span class="keyword">do</span>&#123;</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">        <span class="keyword">if</span>(head-&gt;element == element) <span class="keyword">return</span> i;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;<span class="keyword">while</span>(head-&gt;next);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">sizeList</span><span class="params">(Node head)</span>&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(head-&gt;next)&#123;</span><br><span class="line">        i++;</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//函数都是值传递，传值，值不变；传指针，指针不变；传指针，值会变</span></span><br><span class="line"><span class="comment">//对head-&gt;element或者head-&gt;next操作会改变值</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">printfList</span><span class="params">(Node head)</span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(head-&gt;next)&#123;</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,head-&gt;element);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    Node p1;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> <span class="title">head</span>;</span></span><br><span class="line">    initList(&amp;head);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i)&#123;</span><br><span class="line">        insertList(&amp;head,i*<span class="number">10</span>, i+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    printfList(&amp;head);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,sizeList(&amp;head));</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>链表表是一种顺序访问的存储结构。</p>
<h4 id="3、双向链表"><a href="#3、双向链表" class="headerlink" title="3、双向链表"></a>3、双向链表</h4><h4 id="4、循环链表w"><a href="#4、循环链表w" class="headerlink" title="4、循环链表w"></a>4、循环链表w</h4><h4 id="5、堆栈（Stack）"><a href="#5、堆栈（Stack）" class="headerlink" title="5、堆栈（Stack）"></a>5、堆栈（Stack）</h4><p>先进后出</p>
<h4 id="6、队列（Queue）"><a href="#6、队列（Queue）" class="headerlink" title="6、队列（Queue）"></a>6、队列（Queue）</h4><p>先进先出</p>
<h4 id="实战1、反转链表"><a href="#实战1、反转链表" class="headerlink" title="实战1、反转链表"></a>实战1、反转链表</h4><p>题目描述：给你单链表的头节点 <code>head</code> ，请你反转链表，并返回反转后的链表。</p>
<h5 id="解法一"><a href="#解法一" class="headerlink" title="解法一"></a>解法一</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> E;  <span class="comment">//定义顺序表存储的数据为int</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span>&#123;</span></span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> ListNode* <span class="title function_">reverseList</span><span class="params">(<span class="keyword">struct</span> ListNode* head)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> *<span class="title">tmp</span>,*<span class="title">newHead</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">while</span> (head)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//假设前面已被反转。</span></span><br><span class="line">        tmp = head-&gt;next;	<span class="comment">//保存第二个节点，用于当作下一个节点的头结点。</span></span><br><span class="line">        head-&gt;next = newHead;	<span class="comment">//指向前节点</span></span><br><span class="line">        newHead = head;	<span class="comment">//更新前节点</span></span><br><span class="line">        head = tmp;	<span class="comment">//新链表</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> newHead;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="解法二-递归"><a href="#解法二-递归" class="headerlink" title="解法二:递归"></a>解法二:递归</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> E;  <span class="comment">//定义顺序表存储的数据为int</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span>&#123;</span></span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> ListNode* <span class="title function_">reverseList</span><span class="params">(<span class="keyword">struct</span> ListNode* head)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="literal">NULL</span> || head-&gt;next == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span>* <span class="title">newHead</span> =</span> reverseList(head-&gt;next);</span><br><span class="line">    head-&gt;next-&gt;next = head;</span><br><span class="line">    head-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> newHead;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="实战2、匹配字符串"><a href="#实战2、匹配字符串" class="headerlink" title="实战2、匹配字符串"></a>实战2、匹配字符串</h4><p>给定一个只包括 <code>&#39;(&#39;</code>，<code>&#39;)&#39;</code>，<code>&#39;{&#39;</code>，<code>&#39;}&#39;</code>，<code>&#39;[&#39;</code>，<code>&#39;]&#39;</code> 的字符串 <code>s</code> ，判断字符串是否有效。</p>
<p>有效字符串需满足：</p>
<ol>
<li>左括号必须用相同类型的右括号闭合。</li>
<li>左括号必须以正确的顺序闭合。</li>
<li>每个右括号都有一个对应的相同类型的左括号。</li>
</ol>
<h4 id="方法：栈的应用"><a href="#方法：栈的应用" class="headerlink" title="方法：栈的应用"></a>方法：栈的应用</h4><h5 id="方法1：自己的"><a href="#方法1：自己的" class="headerlink" title="方法1：自己的"></a>方法1：自己的</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> true 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> false 0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">char</span> E;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LNode</span> &#123;</span></span><br><span class="line">    E val;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">LNode</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">LNode</span>* <span class="title">Node</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">initStack</span><span class="params">(Node head)</span>&#123;</span><br><span class="line">    head-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">printStack</span><span class="params">(Node head)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;| &quot;</span>);</span><br><span class="line">    head = head-&gt;next;</span><br><span class="line">    <span class="keyword">while</span> (head)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, head-&gt;val);</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//入栈</span></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">pushStack</span><span class="params">(Node head, E val)</span>&#123;</span><br><span class="line">    Node node = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> LNode));</span><br><span class="line">    <span class="keyword">if</span>(node == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    node-&gt;next = head-&gt;next;</span><br><span class="line">    node-&gt;val = val;</span><br><span class="line">    head-&gt;next = node;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//出栈</span></span><br><span class="line">E <span class="title function_">popStack</span><span class="params">(Node head)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(head-&gt;next == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    Node node;</span><br><span class="line">    node = head-&gt;next;</span><br><span class="line">    E val = node-&gt;val;</span><br><span class="line">    head-&gt;next = head-&gt;next-&gt;next;</span><br><span class="line">    <span class="built_in">free</span>(node);</span><br><span class="line">    <span class="keyword">return</span> val;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">isValid</span><span class="params">(<span class="type">char</span>* s)</span> &#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">LNode</span> <span class="title">head</span>;</span></span><br><span class="line">    initStack(&amp;head);</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">if</span>(len % <span class="number">2</span> == <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    pushStack(&amp;head,s[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; len; i++)&#123;</span><br><span class="line">        E top = popStack(&amp;head);</span><br><span class="line">        <span class="keyword">if</span>(top != <span class="number">0</span>)pushStack(&amp;head,top);</span><br><span class="line">        <span class="keyword">if</span>(top == <span class="string">&#x27;(&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s[i] == <span class="string">&#x27;)&#x27;</span>) popStack(&amp;head);</span><br><span class="line">            <span class="keyword">else</span> pushStack(&amp;head,s[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(top == <span class="string">&#x27;[&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s[i] == <span class="string">&#x27;]&#x27;</span>) popStack(&amp;head);</span><br><span class="line">            <span class="keyword">else</span> pushStack(&amp;head,s[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(top == <span class="string">&#x27;&#123;&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s[i] == <span class="string">&#x27;&#125;&#x27;</span>) popStack(&amp;head);</span><br><span class="line">            <span class="keyword">else</span> pushStack(&amp;head,s[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>  pushStack(&amp;head,s[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(head.next == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">char</span> *s = <span class="string">&quot;()[]&#123;&#125;&quot;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,isValid(s));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="方法2：更快"><a href="#方法2：更快" class="headerlink" title="方法2：更快"></a>方法2：更快</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">char</span> E;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LNode</span> &#123;</span></span><br><span class="line">    E element;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">LNode</span> * <span class="title">next</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">LNode</span> * <span class="title">Node</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">initStack</span><span class="params">(Node head)</span>&#123;</span><br><span class="line">    head-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">pushStack</span><span class="params">(Node head, E element)</span>&#123;</span><br><span class="line">    Node node = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> LNode));</span><br><span class="line">    <span class="keyword">if</span>(node == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    node-&gt;next = head-&gt;next;</span><br><span class="line">    node-&gt;element = element;</span><br><span class="line">    head-&gt;next = node;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">isEmpty</span><span class="params">(Node head)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> head-&gt;next == <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">E <span class="title function_">popStack</span><span class="params">(Node head)</span>&#123;</span><br><span class="line">    Node top = head-&gt;next;</span><br><span class="line">    head-&gt;next = head-&gt;next-&gt;next;</span><br><span class="line">    E e = top-&gt;element;</span><br><span class="line">    <span class="built_in">free</span>(top);</span><br><span class="line">    <span class="keyword">return</span> e;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> <span class="title function_">isValid</span><span class="params">(<span class="type">char</span> * s)</span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">if</span>(len % <span class="number">2</span> == <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;  <span class="comment">//如果长度不是偶数，那么一定不能成功匹配</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">LNode</span> <span class="title">head</span>;</span></span><br><span class="line">    initStack(&amp;head);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        <span class="type">char</span> c = s[i];</span><br><span class="line">        <span class="keyword">if</span>(c == <span class="string">&#x27;(&#x27;</span> || c == <span class="string">&#x27;[&#x27;</span> || c == <span class="string">&#x27;&#123;&#x27;</span>) &#123;</span><br><span class="line">            pushStack(&amp;head, c);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(isEmpty(&amp;head)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">if</span>(c == <span class="string">&#x27;)&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span>(popStack(&amp;head) != <span class="string">&#x27;(&#x27;</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(c == <span class="string">&#x27;]&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span>(popStack(&amp;head) != <span class="string">&#x27;[&#x27;</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(popStack(&amp;head) != <span class="string">&#x27;&#123;&#x27;</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> isEmpty(&amp;head);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="方法三：更快"><a href="#方法三：更快" class="headerlink" title="方法三：更快"></a>方法三：更快</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> <span class="title function_">pairs</span><span class="params">(<span class="type">char</span> a)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (a == <span class="string">&#x27;&#125;&#x27;</span>) <span class="keyword">return</span> <span class="string">&#x27;&#123;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (a == <span class="string">&#x27;]&#x27;</span>) <span class="keyword">return</span> <span class="string">&#x27;[&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (a == <span class="string">&#x27;)&#x27;</span>) <span class="keyword">return</span> <span class="string">&#x27;(&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> <span class="title function_">isValid</span><span class="params">(<span class="type">char</span>* s)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n = <span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">if</span> (n % <span class="number">2</span> == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> stk[n + <span class="number">1</span>], top = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="type">char</span> ch = pairs(s[i]);</span><br><span class="line">        <span class="keyword">if</span> (ch) &#123;</span><br><span class="line">            <span class="keyword">if</span> (top == <span class="number">0</span> || stk[top - <span class="number">1</span>] != ch) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            top--;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            stk[top++] = s[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> top == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="二、数据结构与算法：树"><a href="#二、数据结构与算法：树" class="headerlink" title="二、数据结构与算法：树"></a>二、数据结构与算法：树</h3><h4 id="1、树：理论"><a href="#1、树：理论" class="headerlink" title="1、树：理论"></a>1、树：理论</h4><ul>
<li><p>我们一般称位于最上方的结点为树的<strong>根结点</strong>（Root）；</p>
</li>
<li><p>每个结点连接的子结点数目（分支的数目），我们称为结点的<strong>度</strong>（Degree），而各个结点度的最大值称为<strong>树的度</strong>；</p>
</li>
<li><p>每个结点延伸下去的下一个结点都可以称为一棵<strong>子树</strong>（SubTree）；</p>
</li>
<li><p>每个<strong>结点的层次</strong>（Level）按照从上往下的顺序，树的根结点为<code>1</code>，每向下一层<code>+1</code>，比如<code>G</code>的层次就是<code>3</code>，整棵树中所有结点的最大层次，就是这颗<strong>树的深度</strong>（Depth）；</p>
</li>
<li><p>与当前结点直接向下相连的结点，我们称为<strong>子结点</strong>（Child）；相反即为<strong>父节点</strong>；</p>
</li>
<li><p>如果某个节点没有任何的子结点（结点度为0时）那么我们称这个结点为<strong>叶子结点</strong>；</p>
</li>
<li><p>如果两个结点的父结点是同一个，那么称这两个节点为<strong>兄弟结点</strong>（Sibling）；</p>
</li>
<li><p>从根结点开始一直到某个结点的整条路径的所有结点，都是这个结点的<strong>祖先结点</strong>（Ancestor）；</p>
</li>
</ul>
<h4 id="2、二叉树的性质"><a href="#2、二叉树的性质" class="headerlink" title="2、二叉树的性质"></a>2、二叉树的性质</h4><ul>
<li>性质一： 对于一棵二叉树，第<code>i</code>层的最大结点数量为 个2^i - 1;</li>
<li>一棵深度为<code>k</code>的二叉树最大结点数量为 n &#x3D; 2^k*−1，顺便得出，结点的边数为 E &#x3D; n - 1。</li>
<li>于任何一棵二叉树，如果其叶子结点个数为 n0，度为2的结点个数为 n2 ，那么两者满足以下公式：n0 &#x3D; n2+1;</li>
<li><code>n</code>个结点的完全二叉树深度为 k &#x3D; log2^n + 1 ;</li>
<li></li>
</ul>
<h4 id="3、二叉树遍历：前序、中序、后序遍历"><a href="#3、二叉树遍历：前序、中序、后序遍历" class="headerlink" title="3、二叉树遍历：前序、中序、后序遍历"></a>3、二叉树遍历：前序、中序、后序遍历</h4><p><img src="/%E5%86%8D%E6%8E%A2C%E8%AF%AD%E8%A8%80/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%5C%E4%BA%8C%E5%8F%89%E6%A0%91.png" alt="二叉树"></p>
<p>前序遍历结果为：<code>ABDECF</code>；</p>
<p>中序遍历结果为：<code>DBEACF</code>；</p>
<p>后序遍历结果为：<code>DEBFCA</code>；</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">char</span> E;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span>&#123;</span></span><br><span class="line">    E element;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span> *<span class="title">left</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span> *<span class="title">right</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span>* <span class="title">Node</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//前序递归，利用函数栈的特性，不断出栈入栈</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">preOrder</span><span class="params">(Node root)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(root == <span class="literal">NULL</span>) <span class="keyword">return</span>;   </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, root-&gt;element);</span><br><span class="line">    preOrder(root-&gt;left);</span><br><span class="line">    preOrder(root-&gt;right);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//中序遍历</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">inOrder</span><span class="params">(Node root)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(root == <span class="literal">NULL</span>) <span class="keyword">return</span>;</span><br><span class="line">    inOrder(root-&gt;left);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,root-&gt;element);</span><br><span class="line">    inOrder(root-&gt;right);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//后序遍历</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">afOrder</span><span class="params">(Node root)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(root == <span class="literal">NULL</span>) <span class="keyword">return</span>;</span><br><span class="line">    afOrder(root-&gt;left);</span><br><span class="line">    afOrder(root-&gt;right);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,root-&gt;element);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    Node a = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));</span><br><span class="line">    Node b = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));</span><br><span class="line">    Node c = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));</span><br><span class="line">    Node d = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));</span><br><span class="line">    Node e = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));</span><br><span class="line">    Node f = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));</span><br><span class="line">    a-&gt;element = <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">    b-&gt;element = <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">    c-&gt;element = <span class="string">&#x27;C&#x27;</span>;</span><br><span class="line">    d-&gt;element = <span class="string">&#x27;D&#x27;</span>;</span><br><span class="line">    e-&gt;element = <span class="string">&#x27;E&#x27;</span>;</span><br><span class="line">    f-&gt;element = <span class="string">&#x27;F&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    a-&gt;left = b;</span><br><span class="line">    a-&gt;right = c;</span><br><span class="line">    b-&gt;left = d;</span><br><span class="line">    b-&gt;right = e;</span><br><span class="line">    c-&gt;right = f;</span><br><span class="line">    c-&gt;left = <span class="literal">NULL</span>;</span><br><span class="line">    d-&gt;left = e-&gt;right = <span class="literal">NULL</span>;</span><br><span class="line">    e-&gt;left = e-&gt;right = <span class="literal">NULL</span>;</span><br><span class="line">    f-&gt;left = f-&gt;right = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    afOrder(a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4、二叉树遍历：层序遍历"><a href="#4、二叉树遍历：层序遍历" class="headerlink" title="4、二叉树遍历：层序遍历"></a>4、二叉树遍历：层序遍历</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">char</span> E;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span> &#123;</span></span><br><span class="line">    E element;    <span class="comment">//存放元素</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span> * <span class="title">left</span>;</span>   <span class="comment">//指向左子树的指针</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span> * <span class="title">right</span>;</span>   <span class="comment">//指向右子树的指针</span></span><br><span class="line">&#125; *Node;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">initNode</span>&#123;</span>   <span class="comment">//定义队列初始节点</span></span><br><span class="line">    Node element;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">initNode</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125; *INode;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Queue</span>&#123;</span>   <span class="comment">//队列头尾指针</span></span><br><span class="line">    INode front,rear;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Queue</span>* <span class="title">LinkedQueue</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">initQueue</span><span class="params">(LinkedQueue <span class="built_in">queue</span>)</span>&#123;</span><br><span class="line">    INode node = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> initNode));</span><br><span class="line">    <span class="keyword">if</span>(node == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    node-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="built_in">queue</span>-&gt;front = <span class="built_in">queue</span>-&gt;rear = node;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//入队</span></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">enQueue</span><span class="params">(LinkedQueue quene, Node element)</span>&#123;</span><br><span class="line">    INode node = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> initNode));</span><br><span class="line">    <span class="keyword">if</span>(node == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    node-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    node-&gt;element = element;</span><br><span class="line">    quene-&gt;rear-&gt;next = node;</span><br><span class="line">    quene-&gt;rear = node;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 出队</span></span><br><span class="line">Node <span class="title function_">deQueue</span><span class="params">(LinkedQueue <span class="built_in">queue</span>)</span>&#123;</span><br><span class="line">    Node val = <span class="built_in">queue</span>-&gt;front-&gt;next-&gt;element;</span><br><span class="line">    INode node;</span><br><span class="line">    node = <span class="built_in">queue</span>-&gt;front-&gt;next;</span><br><span class="line">    <span class="built_in">queue</span>-&gt;front-&gt;next = <span class="built_in">queue</span>-&gt;front-&gt;next-&gt;next;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">queue</span>-&gt;rear == node) <span class="built_in">queue</span>-&gt;rear = <span class="built_in">queue</span>-&gt;front;</span><br><span class="line">    <span class="built_in">free</span>(node);</span><br><span class="line">    <span class="keyword">return</span> val;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">isEmpty</span><span class="params">(LinkedQueue <span class="built_in">queue</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">queue</span>-&gt;front == <span class="built_in">queue</span>-&gt;rear);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">levelQueue</span><span class="params">(Node root)</span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Queue</span> <span class="title">queue</span>;</span></span><br><span class="line">    initQueue(&amp;<span class="built_in">queue</span>);</span><br><span class="line">    enQueue(&amp;<span class="built_in">queue</span>,root);</span><br><span class="line">    <span class="keyword">while</span>(!isEmpty(&amp;<span class="built_in">queue</span>))&#123;</span><br><span class="line">        Node node = deQueue(&amp;<span class="built_in">queue</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,node-&gt;element);</span><br><span class="line">        <span class="keyword">if</span>(node-&gt;left) enQueue(&amp;<span class="built_in">queue</span>,node-&gt;left);</span><br><span class="line">        <span class="keyword">if</span>(node-&gt;right) enQueue(&amp;<span class="built_in">queue</span>,node-&gt;right);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    Node a = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));</span><br><span class="line">    Node b = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));</span><br><span class="line">    Node c = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));</span><br><span class="line">    Node d = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));</span><br><span class="line">    Node e = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));</span><br><span class="line">    Node f = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));</span><br><span class="line">    a-&gt;element = <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">    b-&gt;element = <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">    c-&gt;element = <span class="string">&#x27;C&#x27;</span>;</span><br><span class="line">    d-&gt;element = <span class="string">&#x27;D&#x27;</span>;</span><br><span class="line">    e-&gt;element = <span class="string">&#x27;E&#x27;</span>;</span><br><span class="line">    f-&gt;element = <span class="string">&#x27;F&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    a-&gt;left = b;</span><br><span class="line">    a-&gt;right = c;</span><br><span class="line">    b-&gt;left = d;</span><br><span class="line">    b-&gt;right = e;</span><br><span class="line">    c-&gt;right = f;</span><br><span class="line">    c-&gt;left = <span class="literal">NULL</span>;</span><br><span class="line">    d-&gt;left = e-&gt;right = <span class="literal">NULL</span>;</span><br><span class="line">    e-&gt;left = e-&gt;right = <span class="literal">NULL</span>;</span><br><span class="line">    f-&gt;left = f-&gt;right = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    levelQueue(a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5、二叉树的线索化-以前序为例"><a href="#5、二叉树的线索化-以前序为例" class="headerlink" title="5、二叉树的线索化(以前序为例)"></a>5、二叉树的线索化(以前序为例)</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">char</span> E;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span> &#123;</span></span><br><span class="line">    E element;    <span class="comment">//存放元素</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span> * <span class="title">left</span>;</span>   <span class="comment">//指向左子树的指针</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span> * <span class="title">right</span>;</span>   <span class="comment">//指向右子树的指针</span></span><br><span class="line">    <span class="type">char</span> leftFlag,rightFlag     <span class="comment">//线索化标志位</span></span><br><span class="line">&#125; *Node;</span><br><span class="line"></span><br><span class="line">Node pre = <span class="literal">NULL</span>;  <span class="comment">//这里我们需要一个pre来保存后续结点的指向</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">treeOrdered</span><span class="params">(Node root)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(root == <span class="literal">NULL</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//线索化规则：结点的左指针，指向其当前遍历顺序的前驱结点；结点的右指针，指向其当前遍历顺序的后继结点。</span></span><br><span class="line">    <span class="keyword">if</span>(root-&gt;left == <span class="literal">NULL</span>)&#123; <span class="comment">//判断当前节点的左节点是否为空，若为空，则指向上一个节点。</span></span><br><span class="line">        root-&gt;leftFlag = <span class="number">1</span>;</span><br><span class="line">        root-&gt;left = pre;</span><br><span class="line"></span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">if</span>(pre &amp;&amp; pre-&gt;right == <span class="literal">NULL</span>)&#123;  <span class="comment">//判断上一个节点的右节点是否为空，若为空，则指向当前节点</span></span><br><span class="line">        pre-&gt;right = root;</span><br><span class="line">        pre-&gt;rightFlag = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    pre = root;</span><br><span class="line">    <span class="keyword">if</span>(root-&gt;leftFlag == <span class="number">0</span>) treeOrdered(root-&gt;left);    <span class="comment">//判断左节点是否是线索化的，若不是，才能继续。</span></span><br><span class="line">    <span class="keyword">if</span>(root-&gt;rightFlag == <span class="number">0</span>) treeOrdered(root-&gt;right);  <span class="comment">//判断可略，因为，我们对右节点的线索化，是在后面执行的</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">preOrder</span><span class="params">(Node root)</span>&#123; </span><br><span class="line">    <span class="keyword">while</span> (root) &#123;   <span class="comment">//到头为止</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, root-&gt;element);   <span class="comment">//因为是前序遍历，所以直接按顺序打印就行了</span></span><br><span class="line">        <span class="keyword">if</span>(root-&gt;leftFlag == <span class="number">0</span>) </span><br><span class="line">            root = root-&gt;left;   <span class="comment">//如果是左孩子，那么就走左边</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            root = root-&gt;right;   <span class="comment">//如果左边指向是线索，那么就直接走右边。</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Node <span class="title function_">createNode</span><span class="params">(E element)</span>&#123;   <span class="comment">//单独写了个函数来创建结点</span></span><br><span class="line">    Node node = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));</span><br><span class="line">    node-&gt;left = node-&gt;right = <span class="literal">NULL</span>;</span><br><span class="line">    node-&gt;rightFlag = node-&gt;leftFlag = <span class="number">0</span>;</span><br><span class="line">    node-&gt;element = element;</span><br><span class="line">    <span class="keyword">return</span> node;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    Node a = createNode(<span class="string">&#x27;A&#x27;</span>);</span><br><span class="line">    Node b = createNode(<span class="string">&#x27;B&#x27;</span>);</span><br><span class="line">    Node c = createNode(<span class="string">&#x27;C&#x27;</span>);</span><br><span class="line">    Node d = createNode(<span class="string">&#x27;D&#x27;</span>);</span><br><span class="line">    Node e = createNode(<span class="string">&#x27;E&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    a-&gt;left = b;</span><br><span class="line">    b-&gt;left = d;</span><br><span class="line">    a-&gt;right = c;</span><br><span class="line">    b-&gt;right = e;</span><br><span class="line"></span><br><span class="line">    treeOrdered(a);</span><br><span class="line">    preOrder(a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="六、二叉搜索树（二叉查找树）"><a href="#六、二叉搜索树（二叉查找树）" class="headerlink" title="六、二叉搜索树（二叉查找树）"></a>六、二叉搜索树（二叉查找树）</h4><h4 id="七、平衡二叉树"><a href="#七、平衡二叉树" class="headerlink" title="七、平衡二叉树"></a>七、平衡二叉树</h4><h3 id="三、数据结构与算法：哈希表"><a href="#三、数据结构与算法：哈希表" class="headerlink" title="三、数据结构与算法：哈希表"></a>三、数据结构与算法：哈希表</h3><h4 id="1、哈希表"><a href="#1、哈希表" class="headerlink" title="1、哈希表"></a>1、哈希表</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SIZE 9</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//结构体指针，直接用E-&gt;key访问，避免用*E访问</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Element</span> &#123;</span>   <span class="comment">//这里用一个Element将值包装一下</span></span><br><span class="line">    <span class="type">int</span> key;    <span class="comment">//这里元素设定为int</span></span><br><span class="line">&#125; * E;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">HashTable</span>&#123;</span>   <span class="comment">//这里把数组封装为一个哈希表</span></span><br><span class="line">    E * table;</span><br><span class="line">&#125; * HashTable;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">hash</span><span class="params">(<span class="type">int</span> key)</span>&#123;   <span class="comment">//哈希函数</span></span><br><span class="line">    <span class="keyword">return</span> key % SIZE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">init</span><span class="params">(HashTable hashTable)</span>&#123;   <span class="comment">//初始化函数</span></span><br><span class="line">    hashTable-&gt;table = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> Element) * SIZE);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; SIZE; ++i)</span><br><span class="line">        hashTable-&gt;table[i] = <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">insert</span><span class="params">(HashTable hashTable, E element)</span>&#123;   <span class="comment">//插入操作，为了方便就不考虑装满的情况了</span></span><br><span class="line">    <span class="type">int</span> hashCode = hash(element-&gt;key);   <span class="comment">//首先计算元素的哈希值</span></span><br><span class="line">    hashTable-&gt;table[hashCode] = element;   <span class="comment">//对号入座</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">find</span><span class="params">(HashTable hashTable, <span class="type">int</span> key)</span>&#123;</span><br><span class="line">    <span class="type">int</span> hashCode = hash(key);   <span class="comment">//首先计算元素的哈希值</span></span><br><span class="line">    <span class="keyword">if</span>(!hashTable-&gt;table[hashCode]) <span class="keyword">return</span> <span class="number">0</span>;   <span class="comment">//如果为NULL那就说明没有</span></span><br><span class="line">    <span class="keyword">return</span> hashTable-&gt;table[hashCode]-&gt;key == key;  <span class="comment">//如果有，直接看是不是就完事</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">E <span class="title function_">create</span><span class="params">(<span class="type">int</span> key)</span>&#123;    <span class="comment">//创建一个新的元素</span></span><br><span class="line">    E e = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> Element));</span><br><span class="line">    e-&gt;key = key;</span><br><span class="line">    <span class="keyword">return</span> e;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">HashTable</span> <span class="title">hashTable</span>;</span></span><br><span class="line">    init(&amp;hashTable);</span><br><span class="line">    insert(&amp;hashTable, create(<span class="number">10</span>));</span><br><span class="line">    insert(&amp;hashTable, create(<span class="number">7</span>));</span><br><span class="line">    insert(&amp;hashTable, create(<span class="number">13</span>));</span><br><span class="line">    insert(&amp;hashTable, create(<span class="number">29</span>));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, find(&amp;hashTable, <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, find(&amp;hashTable, <span class="number">13</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2、哈希冲突（链地址法）"><a href="#2、哈希冲突（链地址法）" class="headerlink" title="2、哈希冲突（链地址法）"></a>2、哈希冲突（链地址法）</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SIZE 9</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> &#123;</span>   <span class="comment">//结点定义</span></span><br><span class="line">    <span class="type">int</span> key;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> * <span class="title">next</span>;</span></span><br><span class="line">&#125; * Node;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">HashTable</span>&#123;</span>   <span class="comment">//哈希表</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> * <span class="title">table</span>;</span>   <span class="comment">//这个数组专门保存头结点</span></span><br><span class="line">&#125; * HashTable;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">init</span><span class="params">(HashTable hashTable)</span>&#123;</span><br><span class="line">    hashTable-&gt;table = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> ListNode) * SIZE);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; SIZE; ++i) &#123;</span><br><span class="line">        hashTable-&gt;table[i].key = <span class="number">-1</span>;   <span class="comment">//将头结点key置为-1，next指向NULL</span></span><br><span class="line">        hashTable-&gt;table[i].next = <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">hash</span><span class="params">(<span class="type">int</span> key)</span>&#123;   <span class="comment">//哈希函数</span></span><br><span class="line">    <span class="keyword">return</span> key % SIZE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Node <span class="title function_">createNode</span><span class="params">(<span class="type">int</span> key)</span>&#123;   <span class="comment">//创建结点专用函数</span></span><br><span class="line">    Node node = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> ListNode));</span><br><span class="line">    node-&gt;key = key;</span><br><span class="line">    node-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> node;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">insert</span><span class="params">(HashTable hashTable, <span class="type">int</span> key)</span>&#123;</span><br><span class="line">    <span class="type">int</span> hashCode = hash(key);</span><br><span class="line">    Node head = hashTable-&gt;table + hashCode;   <span class="comment">//先计算哈希值，找到位置后直接往链表后面插入结点就完事了</span></span><br><span class="line">    <span class="keyword">while</span> (head-&gt;next) head = head-&gt;next;</span><br><span class="line">    head-&gt;next = createNode(key);   <span class="comment">//插入新的结点</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">find</span><span class="params">(HashTable hashTable, <span class="type">int</span> key)</span>&#123;</span><br><span class="line">    <span class="type">int</span> hashCode = hash(key);</span><br><span class="line">    Node head = hashTable-&gt;table + hashCode;</span><br><span class="line">    <span class="keyword">while</span> (head-&gt;next &amp;&amp; head-&gt;key != key)   <span class="comment">//直到最后或是找到为止</span></span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">    <span class="keyword">return</span> head-&gt;key == key;   <span class="comment">//直接返回是否找到</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">HashTable</span> <span class="title">table</span>;</span></span><br><span class="line">    init(&amp;table);</span><br><span class="line"></span><br><span class="line">    insert(&amp;table, <span class="number">10</span>);</span><br><span class="line">    insert(&amp;table, <span class="number">19</span>);</span><br><span class="line">    insert(&amp;table, <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, find(&amp;table, <span class="number">20</span>));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, find(&amp;table, <span class="number">17</span>));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, find(&amp;table, <span class="number">19</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>













</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/2/">上一页</a></div><div class="pagination-next"><a href="/page/4/">下一页</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><a class="pagination-link" href="/page/2/">2</a></li><li><a class="pagination-link is-current" href="/page/3/">3</a></li><li><a class="pagination-link" href="/page/4/">4</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Your name"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Your name</p><p class="is-size-6 is-block">Your title</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Your location</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives/"><p class="title">33</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories/"><p class="title">11</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags/"><p class="title">23</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ppoffice" target="_blank" rel="me noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/ppoffice"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/MCU%E5%BC%80%E5%8F%91/"><span class="level-start"><span class="level-item">MCU开发</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/RTOS/"><span class="level-start"><span class="level-item">RTOS</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/pyQt/"><span class="level-start"><span class="level-item">pyQt</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E4%B8%8A%E4%BD%8D%E6%9C%BA%E5%BC%80%E5%8F%91/"><span class="level-start"><span class="level-item">上位机开发</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%86%8D%E6%8E%A2C%E8%AF%AD%E8%A8%80/"><span class="level-start"><span class="level-item">再探C语言</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%9F%BA%E7%A1%80/"><span class="level-start"><span class="level-item">嵌入式基础</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"><span class="level-start"><span class="level-item">工具使用</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"><span class="level-start"><span class="level-item">环境配置</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E9%80%9A%E8%AE%AF%E5%8D%8F%E8%AE%AE/"><span class="level-start"><span class="level-item">通讯协议</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E9%A9%B1%E5%8A%A8/"><span class="level-start"><span class="level-item">驱动</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-10-14T16:00:00.000Z">2025-10-15</time></p><p class="title"><a href="/MCU%E5%BC%80%E5%8F%91/STM32%E4%B9%8Bfromelf%E7%9A%84%E4%BD%BF%E7%94%A8/">STM32之fromelf的使用</a></p><p class="categories"><a href="/categories/MCU%E5%BC%80%E5%8F%91/">MCU开发</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-10-14T16:00:00.000Z">2025-10-15</time></p><p class="title"><a href="/MCU%E5%BC%80%E5%8F%91/ST%E4%BA%A7%E5%93%81%E5%9E%8B%E5%8F%B7%E8%A7%A3%E6%9E%90/">ST产品型号解析</a></p><p class="categories"><a href="/categories/MCU%E5%BC%80%E5%8F%91/">MCU开发</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-10-05T16:00:00.000Z">2025-10-06</time></p><p class="title"><a href="/%E9%80%9A%E8%AE%AF%E5%8D%8F%E8%AE%AE/TCP-IP%E5%8D%8F%E8%AE%AE%E6%A6%82%E8%BF%B0/">TCP/IP协议概述</a></p><p class="categories"><a href="/categories/%E9%80%9A%E8%AE%AF%E5%8D%8F%E8%AE%AE/">通讯协议</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-09-29T16:00:00.000Z">2025-09-30</time></p><p class="title"><a href="/RTOS/RT-Thread%E4%B9%8B%E9%82%AE%E7%AE%B1%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B/">RT-Thread之邮箱使用示例</a></p><p class="categories"><a href="/categories/RTOS/">RTOS</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-09-28T16:00:00.000Z">2025-09-29</time></p><p class="title"><a href="/RTOS/RT-Thread%E4%B9%8B%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B/">RT-Thread之消息队列使用示例</a></p><p class="categories"><a href="/categories/RTOS/">RTOS</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2025/10/"><span class="level-start"><span class="level-item">十月 2025</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/09/"><span class="level-start"><span class="level-item">九月 2025</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/08/"><span class="level-start"><span class="level-item">八月 2025</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/07/"><span class="level-start"><span class="level-item">七月 2025</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/06/"><span class="level-start"><span class="level-item">六月 2025</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/05/"><span class="level-start"><span class="level-item">五月 2025</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CAN/"><span class="tag">CAN</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/FreeRTOS/"><span class="tag">FreeRTOS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Git/"><span class="tag">Git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MPU%E5%86%85%E5%AD%98%E4%BF%9D%E6%8A%A4/"><span class="tag">MPU内存保护</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RT-Thread/"><span class="tag">RT-Thread</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/STM32/"><span class="tag">STM32</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/TCP-IP/"><span class="tag">TCP/IP</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Typora/"><span class="tag">Typora</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VScode/"><span class="tag">VScode</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/basic/"><span class="tag">basic</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/conda/"><span class="tag">conda</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/config/"><span class="tag">config</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/envs/"><span class="tag">envs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/python/"><span class="tag">python</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tkinter/"><span class="tag">tkinter</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/typedef/"><span class="tag">typedef</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ubuntu/"><span class="tag">ubuntu</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vscode/"><span class="tag">vscode</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B/"><span class="tag">启动过程</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AF%84%E5%AD%98%E5%99%A8/"><span class="tag">寄存器</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86/"><span class="tag">版本管理</span><span class="tag">1</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="二进制的向阳" height="28"></a><p class="is-size-7"><span>&copy; 2025 Shaokui Li</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script src="/js/pjax.js"></script><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>